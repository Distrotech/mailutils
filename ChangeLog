2006-04-05  Sergey Poznyakoff  <gray@gnu.org.ua>

	* THANKS: Add Willem Jaap Zwart
	* NEWS: Update
	* imap4d/imap4d.h (is_atom): New function
	* imap4d/list.c (print_file,print_dir): Rewrite using an
	auxiliary function. Make sure the string is properly quoted if it
	is not a valid atom.
	* imap4d/util.c (is_atom): New function.
	* libproto/imap/folder.c (list_copy): Do nothing if src is NULL.
	(imap_list): Use mu_argcv_get instead of strtok_r to parse last
	two tokens of the reply, so that file names containing white space
	are processed.
	* mailbox/argcv.c: Fix indentation.

2006-03-12  Sergey Poznyakoff  <gray@gnu.org.ua>

	* imap4d/append.c, imap4d/fetch.c, libproto/imap/mbox.c,
	libproto/mbox/mbox.c, libsieve/actions.c, mailbox/message.c,
	mailbox/message_stream.c, mh/mh_init.c, mh/send.c: Use mu_strftime
	* include/mailutils/envelope.h (MU_ENVELOPE_DATE_FORMAT)
	(MU_ENVELOPE_DATE_LENGTH): New defines
	* include/mailutils/mutil.h (mu_strftime): New function
	* include/mailutils/nls.h (mu_set_locale,mu_restore_locale): New
	functions
	* mailbox/mutil.c (mu_strftime): New function
	* mailbox/nls.c (mu_locale_set): New variable
	(mu_set_locale,mu_restore_locale): New functions
	(mu_init_nls): Use mu_set_locale. Store its return in mu_locale_set.

	* scripts/generr.awk: Report error if no output lines were
	produced. 
	
2006-03-03  Sergey Poznyakoff  <gray@gnu.org.ua>

	* Makefile.am (SUBDIRS): Add libproto
	* configure.ac: Define MU_LIB_.* variables
	(MU_AUTHLIBS): Initialize to empty value.
	(AC_CONFIG_FILES): Add libproto Makefiles

	* libproto: New directory
	* libproto/Makefile.am: New file
	* libproto/imap: New directory
	* libproto/include: New directory
	* libproto/maildir: New directory
	* libproto/mbox: New directory
	* libproto/mh: New directory
	* libproto/nntp: New directory
	* libproto/pop: New directory

	* mailbox/imap/folder.c, mailbox/imap/mbox.c, mailbox/imap/url.c,
	mailbox/imap/Makefile.am, mailbox/imap/.cvsignore: Move to
	libproto/imap 

	* mailbox/include/address0.h, mailbox/include/amd.h,
	mailbox/include/attribute0.h, mailbox/include/auth0.h,
	mailbox/include/body0.h, mailbox/include/debug0.h,
	mailbox/include/envelope0.h, mailbox/include/filter0.h,
	mailbox/include/folder0.h, mailbox/include/header0.h,
	mailbox/include/imap0.h, mailbox/include/iterator0.h,
	mailbox/include/list0.h, mailbox/include/mailbox0.h,
	mailbox/include/mailer0.h, mailbox/include/message0.h,
	mailbox/include/mime0.h, mailbox/include/monitor0.h,
	mailbox/include/observer0.h, mailbox/include/property0.h,
	mailbox/include/registrar0.h, mailbox/include/stream0.h,
	mailbox/include/url0.h, mailbox/include/Makefile.am,
	mailbox/include/.cvsignore: Move to libproto/include 

	* mailbox/maildir/folder.c, mailbox/maildir/maildir.h,
	mailbox/maildir/mbox.c, mailbox/maildir/Makefile.am,
	mailbox/maildir/.cvsignore: Move to libproto/maildir

	* mailbox/mbox/folder.c, mailbox/mbox/mbox.c,
	mailbox/mbox/mbox0.h, mailbox/mbox/mboxscan.c, mailbox/mbox/url.c,
	mailbox/mbox/Makefile.am, mailbox/mbox/.cvsignore: Move to
	libproto/mbox. 
	
	* mailbox/mh/folder.c, mailbox/mh/mbox.c, mailbox/mh/Makefile.am,
	mailbox/mh/.cvsignore: Move to libproto/mh

	* mailbox/nntp/folder.c, mailbox/nntp/mbox.c,
	mailbox/nntp/nntp0.h, mailbox/nntp/nntp_article.c,
	mailbox/nntp/nntp_body.c, mailbox/nntp/nntp_carrier.c,
	mailbox/nntp/nntp_connect.c, mailbox/nntp/nntp_create.c,
	mailbox/nntp/nntp_date.c, mailbox/nntp/nntp_debug.c,
	mailbox/nntp/nntp_destroy.c, mailbox/nntp/nntp_disconnect.c,
	mailbox/nntp/nntp_group.c, mailbox/nntp/nntp_head.c,
	mailbox/nntp/nntp_help.c, mailbox/nntp/nntp_ihave.c,
	mailbox/nntp/nntp_iterator.c, mailbox/nntp/nntp_last.c,
	mailbox/nntp/nntp_list_active.c,
	mailbox/nntp/nntp_list_distribpats.c,
	mailbox/nntp/nntp_list_distributions.c,
	mailbox/nntp/nntp_list_extensions.c,
	mailbox/nntp/nntp_list_newsgroups.c,
	mailbox/nntp/nntp_list_times.c, mailbox/nntp/nntp_mode_reader.c,
	mailbox/nntp/nntp_newgroups.c, mailbox/nntp/nntp_newnews.c,
	mailbox/nntp/nntp_next.c, mailbox/nntp/nntp_post.c,
	mailbox/nntp/nntp_quit.c, mailbox/nntp/nntp_readline.c,
	mailbox/nntp/nntp_response.c, mailbox/nntp/nntp_sendline.c,
	mailbox/nntp/nntp_stat.c, mailbox/nntp/nntp_stream.c,
	mailbox/nntp/nntp_timeout.c, mailbox/nntp/url.c,
	mailbox/nntp/Makefile.am, mailbox/nntp/.cvsignore: Move to
	libproto/nntp 

	* mailbox/pop/folder.c, mailbox/pop/mbox.c,
	mailbox/pop/pop3_apop.c, mailbox/pop/pop3_capa.c,
	mailbox/pop/pop3_carrier.c, mailbox/pop/pop3_connect.c,
	mailbox/pop/pop3_create.c, mailbox/pop/pop3_debug.c,
	mailbox/pop/pop3_dele.c, mailbox/pop/pop3_destroy.c,
	mailbox/pop/pop3_disconnect.c, mailbox/pop/pop3_iterator.c,
	mailbox/pop/pop3_list.c, mailbox/pop/pop3_lista.c,
	mailbox/pop/pop3_noop.c, mailbox/pop/pop3_pass.c,
	mailbox/pop/pop3_quit.c, mailbox/pop/pop3_readline.c,
	mailbox/pop/pop3_response.c, mailbox/pop/pop3_retr.c,
	mailbox/pop/pop3_rset.c, mailbox/pop/pop3_sendline.c,
	mailbox/pop/pop3_stat.c, mailbox/pop/pop3_stls.c,
	mailbox/pop/pop3_stream.c, mailbox/pop/pop3_timeout.c,
	mailbox/pop/pop3_top.c, mailbox/pop/pop3_uidl.c,
	mailbox/pop/pop3_uidla.c, mailbox/pop/pop3_user.c,
	mailbox/pop/url.c, mailbox/pop/Makefile.am,
	mailbox/pop/.cvsignore: Move to libproto/pop. 
	
	* auth/Makefile.am, comsat/Makefile.am, config/Makefile.am,
	dotlock/Makefile.am, examples/Makefile.am, frm/Makefile.am,
	guimb/Makefile.am, imap4d/Makefile.am, libmu_scm/Makefile.am,
	libsieve/Makefile.am, libsieve/extensions/Makefile.am,
	mail/Makefile.am, mail.local/Makefile.am, mail.remote/Makefile.am,
	mailbox/Makefile.am, mapi/Makefile.am, messages/Makefile.am,
	mh/Makefile.am, mimeview/Makefile.am, movemail/Makefile.am,
	pop3d/Makefile.am, readmsg/Makefile.am, sieve/Makefile.am: Use
	MU_LIB_.* variables instead of referring to the libraries by their
	relative paths. 

	* po/POTFILES.in: Update
	
	* mailbox/amd.c: Protect definition of _XOPEN_SOURCE by an extra
	ifdef.
	* libsieve/extensions/vacation.c (regex_comparator): Fix error
	diagnostics
	* mail/mail.h (cursor): Fix declaration

	* mailbox/Makefile.am: Fix INCLUDES and SUBDIRS
	* mailbox/filter_trans.c (base64_encode): Split into two
	functions.
	(B_encode): New function for RFC 2047 encoding
	* mailbox/rfc2047.c: Minor indentation fix
	* mh/mhn.c (finish_msg): Make sure part header is preserved.

2006-02-24  Sergey Poznyakoff  <gray@gnu.org.ua>

	* auth/Makefile.am, libmu_cpp/Makefile.am, libmu_scm/Makefile.am,
	mailbox/imap/Makefile.am, mailbox/maildir/Makefile.am,
	mailbox/mbox/Makefile.am, mailbox/mh/Makefile.am,
	mailbox/nntp/Makefile.am, mailbox/pop/Makefile.am,
	mapi/Makefile.am: Set version info  
	* mailbox/Makefile.am: Compile libmailutils first, then recurse
	into the subdirs.
	* m4/guile.m4: Use improved sed expression, proposed by Thien-Thi
	Nguyen. 
	
2006-02-17  Sergey Poznyakoff  <gray@gnu.org.ua>

	* NEWS: Update

	* mh/mhn.c (split_args): New function
	(_message_is_external_body ): Use split_args to parse
	additional arguments
	(mhn_edit): Fix invocation of edit_modify (was not getting
	additional arguments after ';')
	(parse_header_directive): New function
	(mhn_header): New function
	(mhn_compose): Bugfix: initialize env.line
	Call mhn_header to optionally encode Subject line

	* mailbox/rfc2047.c (mu_rfc2047_encode): Return EINVAL if any of
	the arguments is NULL.

	* frm/common.c (get_personal): Fix coredump on empty From: headers.

2006-02-09  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mailbox/message_stream.c (restore_envelope): Restore line
	accidentally deleted with the recent changes.
	
2006-02-08  Sergey Poznyakoff  <gray@gnu.org.ua>

	Fix displaying source locations in Sieve action logs:
	
	* libsieve/prog.c (sieve_change_source)
	(sieve_check_source_changed): New functions
	(sieve_code_action,sieve_code_test): Call
	sieve_check_source_changed.
	* libsieve/sieve.h (sieve_change_source): New function
	* libsieve/sieve.l (push_source,pop_source): Do not code
	SOURCE instruction directly, use sieve_change_source() to let the
	code generator know it should do it.

	Fix build on platforms without program_invocation_short_name:

	* mailbox/Makefile.am (AM_CFLAGS): Use AM_CPPFLAGS instead.
	* config/Makefile.am, movemail/Makefile.am (AM_CPPFLAGS): Add
	GNULIB_ARGP_EXTERN_BASENAME=1
	* config/mailutils-config.c, movemail/movemail.c: Include
	argp-namefrob.h 

2006-02-07  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mailbox/stream.c (mu_stream_getline)
	(mu_stream_sequential_getline): New function

	* mailbox/message_stream.c (_mu_rfc822_open, restore_envelope): Use
	mu_stream_getline

	* include/mailutils/stream.h (mu_stream_getline)
	(mu_stream_sequential_getline): New function

	* include/mailutils/libsieve.h (mu_sieve_machine_inherit_report):
	Replace by mu_sieve_machine_inherit
	* libsieve/sieve.y: Likewise
	* libsieve/extensions/moderator.c: Likewise.
	* libsieve/extensions/vacation.c: Fix the leading comment.
	* mailbox/argp-namefrob.h: Restored changes accidentally lost in
	gnulib.

2006-02-06  Sergey Poznyakoff  <gray@gnu.org.ua>

	* NEWS: Raise version number to 0.6.93
	* include/mailutils/libsieve.h (mu_sieve_machine_dup)
	(mu_sieve_machine_inherit_report): New functions
	* include/mailutils/message.h (mu_stream_to_message): New
	function.
	* include/mailutils/mutil.h (mu_mh_delim): New function
	* libsieve/actions.c: Minor stylistic changes
	* libsieve/require.c: Likewise
	* libsieve/sieve.h: Likewise
	* libsieve/sieve.y (mu_sieve_machine_inherit_report)
	(mu_sieve_machine_dup): New functions
	* libsieve/util.c: Minor stylistic changes
	* libsieve/extensions/moderator.c: New file. Automatic moderator
	for Mailman-driven mailing lists.
	* libsieve/extensions/Makefile.am: Add moderator module
	
	* mailbox/message_stream.c: New file. Derived from mh/mh_stream.c
	* mailbox/Makefile.am: Add message_stream.c
	* mailbox/mutil.c (mu_mh_delim): New function
	* mh/mh_stream.c: Rewritten using mu_stream_to_message. Actually,
	the source can be removed now and the function moved elsewhere,
	e.g. to mh_init...
	* sieve/sieve.c (main): Register all mailbox/mailer formats.
	
2006-01-27  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mh/comp.c: Fix semantics of -build/-draftmessage/-[no]draftfolder
	options for compatibility with other implementations of MH
	* mh/forw.c: Likewise
	* mh/whatnow.c: Likewise
	* mh/repl.c: Likewise
	* mh/compcommon.c: Bugfix.
	* mh/mh.h (mh_draft_message): New prototype.
	(xmalloc,xrealloc): Remove prototypes
	* mh/mh_argp.c (parse_opt): Pass ARGP_KEY_INIT to the application
	handler.
	* mh/mh_init.c (mh_draft_message): New function
	* mh/mh_whatnow.c (quit): Don't call rename if both file and
	draftfile are the same.

	* imap4d/select.c (imap4d_select0): Fix status display.

2006-01-25  Sergey Poznyakoff  <gray@gnu.org.ua>

	* imap4d/select.c (imap4d_select0): Create INBOX if it does not
	exist.

	* mailbox/Makefile.am (AM_CFLAGS): Define
	GNULIB_ARGP_EXTERN_BASENAME
	* mailbox/argp-namefrob.h: Bugfix (stray #)
	* mailbox/mutil.c (__argp_base_name): New function

	* THANKS: Add Helmut Leitner.
	* mail/mail.c (parse_opt): Try to catch arguments separated from
	the option by whitespace. Solution proposed by Helmut Leitner.
	Avoid queueing multiple "set mode=send" options.

	* sql/mysql.c (connect): Initialize socket_name to NULL

	* include/mailutils/compat.h (registrar_lookup): Define to
	mu_0_6_registrar_lookup
	* include/mailutils/mailbox.h (mu_mailbox_set_default_proto)
	(mu_mailbox_get_default_proto): New prototypes.
	* include/mailutils/registrar.h (mu_registrar_lookup): Changed
	declaration.
	(mu_0_6_registrar_lookup): New prototype.
	* mailbox/mailbox.c (mu_mailbox_set_default_proto)
	(mu_mailbox_get_default_proto): New functions.
	(mu_mailbox_create): Append default_proto to the mailbox URL, if
	the latter does not already contain one.
	Update invocation of mu_registrar_lookup

	* mailbox/mbx_default.c (tilde_expand): Remove
	(mu_mailbox_create_default): Use  mu_tilde_expansion instead of
	tilde_expand
	
	* mailbox/mu_argp.c (mu_mailbox_argp_option)
	(mu_common_argp_parser): New option --mailbox-type
	* mailbox/mutil.c (mu_tilde_expansion): Expand tilde after
	the protocol specification.

	* mailbox/registrar.c (mu_registrar_lookup): Return error
	code. Use an extra argument to return the flags.
	(mu_0_6_registrar_lookup): New function for compatibility with
	previous versions.
	
	* mailbox/folder.c: Update invocations of mu_registrar_lookup
	* mailbox/mailer.c: Likewise
	* mailbox/mbox/folder.c: Likewise.

	* NEWS: Update
	
2006-01-24  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mh/mh_ctx.c (mh_context_read): Allow for empty lines and
	conventional comment characters ('#') in the context file. 
	* mh/mh_init.c (mh_is_my_name): Bugfix: do not use strtok_r, which 
	modifies its argument.
	
	* include/mailutils/header.h (MU_HEADER_X_MAILER): New define
	* mail/send.c (mail_send0): Use MU_HEADER_X_MAILER
	* mh/replcomps: Remove X-Mailer. Send will add it if needed.
	* mh/replgroupcomps: Likewise
	* mh/send.c (read_mts_profile): Support localname and localdomain
	variables.
	(read_mts_profile): Support x-mailer variable.
	* NEWS: Updated

2006-01-23  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mail/mail.h (exec_compl): New prototype
	* mail/mailline.c (ml_command_completion): Fix coredump
	(exec_compl,exec_generator): New functions
	* mail/table.c: Use exec_compl to complete first argument to !

	* mailbox/parse822.c (mu_parse822_time): Assume UTC for invalid or
	unknown timezones.

2006-01-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	Sources before this point are tagged alpha_0_6_92
	
	* mailbox/mu_umaxtostr.c: New file
	* mailbox/mu_umaxtostr.h: New file

	* configure.ac: Remove HAVE_DECL_PROGRAM_INVOCATION_NAME hack,
	newer argp does that itself.
	Raise version number to 0.6.93
	* gnulib.modules (mailutils): Add inttostr
	* examples/Makefile.am, imap4d/Makefile.am,
	libsieve/extensions/Makefile.am, pop3d/Makefile.am  (AM_LDFLAGS):
	Load libmuaux before libmailutils. 
	
	* mailbox/imap/Makefile.am (libmu_imap_la_LIBADD): New variable
	* mailbox/pop/Makefile.am (libmu_pop_la_LIBADD): New variable
	
	* examples/muemail.c: Include stdlib.h
	
	* imap4d/fetch.c, imap4d/imap4d.c, imap4d/search.c,
	mailbox/daemon.c, mailbox/message.c, mailbox/imap/mbox.c,
	mh/burst.c, mh/compcommon.c, mh/folder.c, mh/forw.c,
	mh/mh_global.c, mh/mh_msgset.c, mh/mh_sequence.c, mh/mhn.c,
	mh/mhpath.c, mh/pick.c, mh/repl.c, mh/sortm.c, pop3d/apop.c,
	pop3d/capa.c, pop3d/dele.c, pop3d/list.c, pop3d/logindelay.c,
	pop3d/pop3d.c, pop3d/stat.c, pop3d/uidl.c, pop3d/user.c: Use
	mu_umaxtostr to format size_t and off_t values
	
	* imap4d/imap4d.h, libmu_scm/mu_port.c, mh/mh.h, pop3d/pop3d.h:
	Include mu_umaxtostr.h 
	
	* mh/mh_format.c: Recognize EET and EEST time zones
	
	* mailbox/pop/mbox.c: Fix parsing of pop3 server replies.
	Use mu_umaxtostr to format size_t and off_t values
	
	* mailbox/imap/folder.c: Add gettext markers
	* mailbox/mbox/mbox.c: Likewise
	* mailbox/mbox/mbox0.h: Include mailutils/nls.h
	
	* mail/set.c, mail/unset.c, mail/mail.h,
	mail/util.c (util_printenv): Change return type to void. 
	All callers updated.

	* mail.local/mail.local.h: Define USE_MAILBOX_QUOTAS after
	including mu_dbm.h
	* mail.local/mailquota.c: Issue error message if unable to open
	the database.

	* mailbox/Makefile.am (AM_CFLAGS): Define
	GNULIB_ARGP_DISABLE_DIRNAME
	(EXTRA_DIST): Remove pin.c

	* po/POTFILES.in: Updated. Sorted alphabetically

	* scripts/gnulib-sync (expand_modules): Implement 'avoid' feature.
	Avoid expanding dirname into mailbox/, since it drags xalloc with
	it. 
	
	Update by gnulib-sync.

	* lib/fnmatch.c: Updated  
	* lib/malloc.c: Updated
	* lib/strcasecmp.c: Updated
	* lib/strncasecmp.c: Updated
	* m4/gnulib.m4: Updated
	* m4/xstrtol.m4: Updated
	
	* lib/allocsa.c: Updated
	* lib/allocsa.h: Updated
	* lib/allocsa.valgrind: Updated
	* lib/asprintf.c: Updated
	* lib/error.c: Updated
	* lib/error.h: Updated
	* lib/exit.h: Updated
	* lib/exitfail.c: Updated
	* lib/exitfail.h: Updated
	* lib/getpass.c: Updated
	* lib/getpass.h: Updated
	* lib/mbswidth.c: Updated
	* lib/mbswidth.h: Updated
	* lib/obstack.c: Updated
	* lib/obstack.h: Updated
	* lib/realloc.c: Updated
	* lib/setenv.c: Updated
	* lib/setenv.h: Updated
	* lib/snprintf.c: Updated
	* lib/snprintf.h: Updated
	* lib/unsetenv.c: Updated
	* lib/vasprintf.c: Updated
	* lib/vasprintf.h: Updated
	* lib/xalloc-die.c: Updated
	* lib/xalloc.h: Updated
	* lib/xmalloc.c: Updated
	* lib/xsize.h: Updated
	* m4/alloca.m4: Updated
	* m4/allocsa.m4: Updated
	* m4/argp.m4: Updated
	* m4/d-type.m4: Updated
	* m4/eealloc.m4: Updated
	* m4/eoverflow.m4: Updated
	* m4/error.m4: Updated
	* m4/exitfail.m4: Updated
	* m4/extensions.m4: Updated
	* m4/fnmatch.m4: Updated
	* m4/getdelim.m4: Updated
	* m4/getline.m4: Updated
	* m4/getlogin_r.m4: Updated
	* m4/getopt.m4: Updated
	* m4/getpass.m4: Updated
	* m4/glob.m4: Updated
	* m4/intmax_t.m4: Updated
	* m4/inttostr.m4: Added to the repository
	* m4/inttypes.m4: Updated
	* m4/inttypes_h_gl.m4: Updated
	* m4/inttypes_h_gl.m4: Updated
	* m4/longdouble.m4: Updated
	* m4/longdouble.m4: Updated
	* m4/longlong_gl.m4: Updated
	* m4/longlong_gl.m4: Updated
	* m4/mbchar.m4: Updated
	* m4/mbiter.m4: Updated
	* m4/mbrtowc.m4: Updated
	* m4/mbrtowc.m4: Updated
	* m4/mbstate_t.m4: Updated
	* m4/mbstate_t.m4: Updated
	* m4/mbswidth.m4: Updated
	* m4/md5.m4: Updated
	* m4/memchr.m4: Updated
	* m4/mempcpy.m4: Updated
	* m4/minmax.m4: Updated
	* m4/obstack.m4: Updated
	* m4/onceonly.m4: Updated
	* m4/onceonly.m4: Updated
	* m4/regex.m4: Updated
	* m4/restrict.m4: Updated
	* m4/setenv.m4: Updated
	* m4/signed.m4: Updated
	* m4/size_max.m4: Updated
	* m4/snprintf.m4: Updated
	* m4/stat-macros.m4: Updated
	* m4/stdbool.m4: Updated
	* m4/stdint.m4: Updated
	* m4/stdint_h_gl.m4: Updated
	* m4/stdint_h_gl.m4: Updated
	* m4/strcase.m4: Updated
	* m4/strchrnul.m4: Updated
	* m4/strdup.m4: Updated
	* m4/strerror_r.m4: Updated
	* m4/strndup.m4: Updated
	* m4/strnlen.m4: Updated
	* m4/strtok_r.m4: Updated
	* m4/sysexits.m4: Updated
	* m4/uintmax_t_gl.m4: Updated
	* m4/uintmax_t_gl.m4: Updated
	* m4/ulonglong_gl.m4: Updated
	* m4/ulonglong_gl.m4: Updated
	* m4/vasnprintf.m4: Updated
	* m4/vasprintf.m4: Updated
	* m4/vsnprintf.m4: Updated
	* m4/wchar_t.m4: Updated
	* m4/wint_t.m4: Updated
	* m4/xalloc.m4: Updated
	* m4/xsize.m4: Updated
	* m4/xsize.m4: Updated
	* mailbox/alloca.c: Updated
	* mailbox/alloca_.h: Updated
	* mailbox/argp-ba.c: Updated
	* mailbox/argp-eexst.c: Updated
	* mailbox/argp-fmtstream.c: Updated
	* mailbox/argp-fmtstream.h: Updated
	* mailbox/argp-fs-xinl.c: Updated
	* mailbox/argp-help.c: Updated
	* mailbox/argp-namefrob.h: Updated
	* mailbox/argp-parse.c: Updated
	* mailbox/argp-pin.c: Added to the repository
	* mailbox/argp-pv.c: Updated
	* mailbox/argp-pvh.c: Updated
	* mailbox/argp-xinl.c: Updated
	* mailbox/argp.h: Updated
	* mailbox/asnprintf.c: Updated
	* mailbox/fnmatch.c: Updated
	* mailbox/fnmatch_.h: Updated
	* mailbox/fnmatch_loop.c: Updated
	* mailbox/getdelim.c: Updated
	* mailbox/getdelim.h: Updated
	* mailbox/getline.c: Updated
	* mailbox/getline.h: Updated
	* mailbox/getlogin_r.c: Updated
	* mailbox/getlogin_r.h: Updated
	* mailbox/getopt.c: Updated
	* mailbox/getopt1.c: Updated
	* mailbox/getopt_.h: Updated
	* mailbox/getopt_int.h: Updated
	* mailbox/gettext.h: Updated
	* mailbox/glob-libc.h: Updated
	* mailbox/glob.c: Updated
	* mailbox/glob_.h: Updated
	* mailbox/imaxtostr.c: Added to the repository
	* mailbox/intprops.h: Added to the repository
	* mailbox/inttostr.c: Added to the repository
	* mailbox/inttostr.h: Added to the repository
	* mailbox/malloc.c: Updated
	* mailbox/mbchar.c: Updated
	* mailbox/mbchar.h: Updated
	* mailbox/mbuiter.h: Updated
	* mailbox/md5.c: Updated
	* mailbox/md5.h: Updated
	* mailbox/memchr.c: Updated
	* mailbox/mempcpy.c: Updated
	* mailbox/mempcpy.h: Updated
	* mailbox/minmax.h: Updated
	* mailbox/offtostr.c: Added to the repository
	* mailbox/printf-args.c: Updated
	* mailbox/printf-args.h: Updated
	* mailbox/printf-parse.c: Updated
	* mailbox/printf-parse.h: Updated
	* mailbox/regcomp.c: Updated
	* mailbox/regex.c: Updated
	* mailbox/regex.h: Updated
	* mailbox/regex_internal.c: Updated
	* mailbox/regex_internal.h: Updated
	* mailbox/regexec.c: Updated
	* mailbox/size_max.h: Updated
	* mailbox/stat-macros.h: Updated
	* mailbox/stdbool_.h: Updated
	* mailbox/stdint_.h: Updated
	* mailbox/strcase.h: Updated
	* mailbox/strcasecmp.c: Updated
	* mailbox/strchrnul.c: Updated
	* mailbox/strchrnul.h: Updated
	* mailbox/strdup.c: Updated
	* mailbox/strdup.h: Updated
	* mailbox/strncasecmp.c: Updated
	* mailbox/strndup.c: Updated
	* mailbox/strndup.h: Updated
	* mailbox/strnlen.c: Updated
	* mailbox/strnlen.h: Updated
	* mailbox/strnlen1.c: Updated
	* mailbox/strnlen1.h: Updated
	* mailbox/strtok_r.c: Updated
	* mailbox/strtok_r.h: Updated
	* mailbox/sysexit_.h: Updated
	* mailbox/umaxtostr.c: Added to the repository
	* mailbox/vasnprintf.c: Updated
	* mailbox/vasnprintf.h: Updated
	* mailbox/vsnprintf.c: Updated
	* mailbox/vsnprintf.h: Updated
	* mailbox/xsize.h: Updated

2006-01-20  Sergey Poznyakoff  <gray@gnu.org.ua>

	Fix bug reported by Ronan KERYELL <Ronan.Keryell@enstb.org>
	(Debian Bug#344420):
	
	* mailbox/file_stream.c (_file_write): Return ENOSPC if fwrite
	returns 0.
	* mailbox/mbox/mbox.c (mbox_append_message0): Preserve return
	status from mu_stream_write, if it is not 0.
	* movemail/movemail.c (main): Exit on first detected IO
	error. Make sure the source mailbox is not modified if not all
	messages were moved successfully.

	* THANKS: Add Ronan KERYELL

	Support automatic home directory creation in imap4d
	
	* imap4d/authenticate.c (imap4d_authenticate): Call
	imap4d_check_home_dir before switching to user's privileges. Bail
	out if it returns with an error.
	Use util_chdir instead of chdir to change to user's home
	directory.
	* imap4d/login.c (imap4d_login): Likewise
	* imap4d/imap4d.c (create_home_dir,home_dir_mode): New variables
	(options): New option --create-home-dir
	(imap4d_check_home_dir): New function
	* imap4d/imap4d.h (imap4d_check_home_dir,util_chdir): New
	prototype.
	* imap4d/util.c (util_chdir): New function.	
	* doc/texinfo/programs.texi: Document --create-home-dir option.
	* NEWS: Update
	
2006-01-18  Sergey Poznyakoff  <gray@gnu.org.ua>

	* README-alpha: Update cvs co information

2006-01-16  Sergey Poznyakoff  <gray@gnu.org.ua>

	* NEWS: Updated
	* THANKS: Add Walter Neumann
	* doc/texinfo/programs.texi: Document inplacealiases and
	recursealiases.
	* mail/alias.c (alias_expand): Recursively expand aliases if
	recursealiases is set.
	* mail/mail.c (default_setup): Provide defaults for inplacealiases
	and recursealiases.
	* mail/mail.h (is_address_field): New prototype.
	* mail/send.c (compose_header_set): Check for valid arguments at
	the beginning of the function (value can be NULL, e.g. if the user hit
	C-D at Cc: prompt).
	Call util_merge_addresses() only if inplacealiases is set. Expand
	aliases before calling it.
	* mail/util.c (is_address_field): Remove static qualifier.
	(util_header_expand): Expand aliases unless inplacealiases is set.
	* mail/testsuite/mail/send.exp: Set inplacealiases.

2005-12-14  Sergey Poznyakoff  <gray@gnu.org.ua>

	* lib/mu_dbm.c: Allow specifying full file name (including the
	suffix). 

2005-12-08  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mh/comp.c, mh/forw.c, mh/repl.c: Make sure -nodraftfolder
	cancels Draft-Folder variable, not only -draftfolder option.

2005-12-05  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mail/util.c (util_do_command): Bugfix

2005-12-04  Sergey Poznyakoff  <gray@gnu.org.ua>

	* imap4d/list.c (list_file,print_dir,print_file): Use
	mkfullname. Fixes [bug #15144].

	* imap4d/create.c: Do not create anything and return OK if the
	argument is suffixed with a hierarchy separator. Fixes [bug #15142].
	* imap4d/status.c (imap4d_status): Flush attributes before opening
	the mailbox.
	(status_unseen): Remove superfluous condition
	Fixes [bug #15143].
	
2005-12-03  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mh/burst.c (finish_stream): Set map.first if necessary
	(burst_digest): Initialize eb_length
	(burst_rename): Skip messages that do not need to be renamed.
	(main): Do not process inplace if burst_count is 0

	* include/mailutils/stream.h (mu_temp_file_stream_create): New
	function.
	* mailbox/file_stream.c: Likewise.
	
	* mh/burst.c: New option --length allows to set a minimal
	encapsulation boundary length.
	(burst_digest): Take into account minimal EB length.

	* mh/README: Update
	* mh/TODO: Update

	* mh/burst.c (burst): Keep message sequence number in msgno.
	(burst_rename): Fix loop limits
	(main): Fix calculation of last_uid.
	Keep message sequence numbers in ms.
	(burst_digest): Initial implementation of RFC 934

2005-11-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* doc/rfc/rfc934.txt: New file.
	* doc/rfc/Makefile.am (EXTRA_DIST): Add rfc934.txt

	* mailbox/amd.c (amd_msg_lookup): Bugfix. Use msg_count == 0
	to determine if the msg_array is empty.
	* mailbox/mime.c (mu_mime_get_part): Set stream_size function.

	* mh/burst.c: New file. Initial implementation of burst command.
	* mh/Makefile.am (PROGRAMS_MH,EXTRA_PROGRAMS): Add burst
	* mh/TODO: Update
	* mh/forw.c (msg_copy): Implement FSA described in RFC 934
	* mh/mh_getopt.h (enum mh_arg): New declaration, instead of
	multiple defines.
	* mh/mh_init.c (mh_expand_name): Accept names starting with mh:/
	protocol indicator.
	* mh/.cvsignore: Add burst, sort entries.
	
2005-11-28  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mailbox/header.c: Fix indentation
	* mh/mh.h (mh_context_destroy,mh_context_merge): New proto
	* mh/mh_ctx.c (mh_context_destroy,mh_context_merge): New
	functions.
	* mh/mh_init.c (mh_expand_name): Make sure the returned value can
	safely be freed.
	* mh/send.c (read_mts_profile): Allow .mtstailor to override
	system-wide configuration values.

2005-11-26  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mail/msgset.y (msgset_negate): Fix loop break condition.

	* sieve/sieve.c (options): Add --dry-run, an alias for -n. 

2005-11-25  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mail/cd.c, mh/folder.c: Fix diagnostic messages

2005-11-16  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: Declare HAVE_DECL_PROGRAM_INVOCATION_NAME,
	otherwise argp-help.c can bail out at line 1693
	* examples/argcv.c: Temporarily include config.h to make sure
	replaced symbols are referenced properly.
	The use of config.h in example files should be reduced to minimum.
	
	* auth/sql.h (sql_interface): Fix data type
	* include/mailutils/errno.hin: Include errno.h
	Provide ECANCELED if it is missing (mainly for cygwin).
	* mailbox/errors (MU_ERR_CANCELED): New error code.

	* Makefile.am (EXTRA_DIST): Remove MU_EXTRA_DIST
	* configure.ac: Call MU_FINISH
	* m4/mu_libobj.m4 (MU_LIBSOURCE,MU_LIBSOURCES): Construct the list
	of EXTRA_DIST sources.
	(MU_FINISH): New defun
	* mailbox/Makefile.am (EXTRA_DIST): Add MU_EXTRA_DIST

2005-11-15  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: Determine the size of off_t and define an
	equivalent mu_off_t type. We cannot use off_t in the library since
	its size depends on whether large file support is used or not,
	which will lead to arbitrary crashes if a user application and the
	library use off_t of different sizes. 
	(MU_COMMON_INCLUDES): New substitute variable
	
	* gnulib.modules (mailutils): Add glob

	* include/mailutils/types.h: Removed
	* include/mailutils/types.hin: New file
	* include/mailutils/Makefile.am: Build types.h
	
	* auth/Makefile.am (UNCLUDES): Rewritten using MU_COMMON_INCLUDES
	* comsat/Makefile.am: Likewise
	* config/Makefile.am: Likewise
	* dotlock/Makefile.am: Likewise
	* examples/Makefile.am: Likewise
	* frm/Makefile.am: Likewise
	* guimb/Makefile.am: Likewise
	* imap4d/Makefile.am: Likewise
	* lib/Makefile.am: Likewise
	* libmu_cpp/Makefile.am: Likewise
	* libmu_scm/Makefile.am: Likewise
	* libsieve/Makefile.am: Likewise
	* libsieve/extensions/Makefile.am: Likewise
	* mail/Makefile.am: Likewise
	* mail.local/Makefile.am: Likewise
	* mail.remote/Makefile.am: Likewise
	* mailbox/Makefile.am: Likewise
	* mailbox/imap/Makefile.am: Likewise
	* mailbox/maildir/Makefile.am: Likewise
	* mailbox/mbox/Makefile.am: Likewise
	* mailbox/mh/Makefile.am: Likewise
	* mailbox/nntp/Makefile.am: Likewise
	* mailbox/pop/Makefile.am: Likewise
	* mapi/Makefile.am: Likewise
	* messages/Makefile.am: Likewise
	* mh/Makefile.am: Likewise
	* mimeview/Makefile.am: Likewise
	* movemail/Makefile.am: Likewise
	* pop3d/Makefile.am: Likewise
	* readmsg/Makefile.am: Likewise
	* sieve/Makefile.am: Likewise
	* sql/Makefile.am: Likewise
	
	* auth/tls.c: Use mu_off_t instead of off_t
	* examples/argcv.c: Likewise
	* examples/base64.c: Likewise
	* examples/mimetest.c: Likewise
	* examples/murun.c: Likewise
	* examples/nntpclient.c: Likewise
	* examples/pop3client.c: Likewise
	* include/mailutils/header.h: Likewise
	* include/mailutils/mailbox.h: Likewise
	* include/mailutils/stream.h: Likewise
	* include/mailutils/types.h: Likewise
	* libmu_scm/mu_port.c: Likewise
	
	* mail.local/main.c: Likewise
	* mailbox/amd.c: Likewise
	* mailbox/body.c: Likewise
	* mailbox/file_stream.c: Likewise
	* mailbox/filter.c: Likewise
	* mailbox/filter_iconv.c: Likewise
	* mailbox/filter_rfc822.c: Likewise
	* mailbox/filter_trans.c: Likewise
	* mailbox/header.c: Likewise
	* mailbox/mailbox.c: Likewise
	* mailbox/mapfile_stream.c
	* mailbox/memory_stream.c
	* mailbox/message.c: Likewise
	* mailbox/mime.c: Likewise
	* mailbox/stream.c: Likewise
	* mailbox/tcp.c: Likewise
	* mailbox/imap/folder.c: Likewise
	* mailbox/imap/mbox.c: Likewise
	* mailbox/include/amd.h: Likewise
	* mailbox/include/filter0.h: Likewise
	* mailbox/include/header0.h: Likewise
	* mailbox/include/imap0.h: Likewise
	* mailbox/include/mailbox0.h: Likewise
	* mailbox/include/stream0.h: Likewise
	* mailbox/mbox/mbox.c: Likewise
	* mailbox/mbox/mboxscan.c: Likewise
	* mailbox/nntp/mbox.c: Likewise
	* mailbox/nntp/nntp_stream.c: Likewise
	* mailbox/pop/mbox.c: Likewise
	* mailbox/pop/pop3_stream.c: Likewise
	* mh/mh_stream.c: Likewise
	* pop3d/pop3d.c: Likewise

	* m4/gnulib.m4: Update
	* m4/mu_libobj.m4: Update
	
	Update by gnulib-sync:

	* lib/allocsa.c: Updated
	* lib/allocsa.h: Updated
	* lib/allocsa.valgrind: Updated
	* lib/asprintf.c: Updated
	* lib/error.c: Updated
	* lib/error.h: Updated
	* lib/exit.h: Updated
	* lib/exitfail.c: Updated
	* lib/exitfail.h: Updated
	* lib/getpass.c: Updated
	* lib/getpass.h: Updated
	* lib/intprops.h: Updated
	* lib/mbswidth.c: Updated
	* lib/mbswidth.h: Updated
	* lib/obstack.c: Updated
	* lib/obstack.h: Updated
	* lib/realloc.c: Updated
	* lib/setenv.c: Updated
	* lib/setenv.h: Updated
	* lib/snprintf.c: Updated
	* lib/snprintf.h: Updated
	* lib/unsetenv.c: Updated
	* lib/vasprintf.c: Updated
	* lib/vasprintf.h: Updated
	* lib/xalloc-die.c: Updated
	* lib/xalloc.h: Updated
	* lib/xmalloc.c: Updated
	* lib/xsize.h: Updated
	* lib/xstrtol.c: Updated
	* lib/xstrtol.h: Updated
	* lib/xstrtoul.c: Updated
	* m4/alloca.m4: Updated
	* m4/allocsa.m4: Updated
	* m4/argp.m4: Updated
	* m4/d-type.m4: Added to the repository
	* m4/eealloc.m4: Updated
	* m4/eoverflow.m4: Updated
	* m4/error.m4: Updated
	* m4/exitfail.m4: Updated
	* m4/extensions.m4: Updated
	* m4/fnmatch.m4: Updated
	* m4/getdelim.m4: Updated
	* m4/getline.m4: Updated
	* m4/getlogin_r.m4: Added to the repository
	* m4/getopt.m4: Updated
	* m4/getpass.m4: Updated
	* m4/glob.m4: Added to the repository
	* m4/intmax_t.m4: Updated
	* m4/inttypes.m4: Updated
	* m4/inttypes_h_gl.m4: Updated
	* m4/longdouble.m4: Updated
	* m4/longlong_gl.m4: Updated
	* m4/mbchar.m4: Updated
	* m4/mbiter.m4: Added to the repository
	* m4/mbrtowc.m4: Updated
	* m4/mbstate_t.m4: Updated
	* m4/mbswidth.m4: Updated
	* m4/md5.m4: Updated
	* m4/memchr.m4: Updated
	* m4/mempcpy.m4: Updated
	* m4/minmax.m4: Updated
	* m4/obstack.m4: Updated
	* m4/onceonly.m4: Updated
	* m4/regex.m4: Updated
	* m4/restrict.m4: Updated
	* m4/setenv.m4: Updated
	* m4/signed.m4: Updated
	* m4/size_max.m4: Updated
	* m4/snprintf.m4: Updated
	* m4/stat-macros.m4: Added to the repository
	* m4/stdbool.m4: Updated
	* m4/stdint.m4: Added to the repository
	* m4/stdint_h_gl.m4: Updated
	* m4/strcase.m4: Updated
	* m4/strchrnul.m4: Updated
	* m4/strdup.m4: Added to the repository
	* m4/strerror_r.m4: Updated
	* m4/strndup.m4: Updated
	* m4/strnlen.m4: Updated
	* m4/strtok_r.m4: Updated
	* m4/sysexits.m4: Updated
	* m4/uintmax_t_gl.m4: Updated
	* m4/ulonglong_gl.m4: Updated
	* m4/vasnprintf.m4: Updated
	* m4/vasprintf.m4: Updated
	* m4/vsnprintf.m4: Updated
	* m4/wchar_t.m4: Updated
	* m4/wint_t.m4: Updated
	* m4/xalloc.m4: Updated
	* m4/xsize.m4: Updated
	* m4/xstrtol.m4: Updated
	* mailbox/alloca.c: Updated
	* mailbox/alloca_.h: Updated
	* mailbox/argp-ba.c: Updated
	* mailbox/argp-eexst.c: Updated
	* mailbox/argp-fmtstream.c: Updated
	* mailbox/argp-fmtstream.h: Updated
	* mailbox/argp-fs-xinl.c: Updated
	* mailbox/argp-help.c: Updated
	* mailbox/argp-namefrob.h: Updated
	* mailbox/argp-parse.c: Updated
	* mailbox/argp-pv.c: Updated
	* mailbox/argp-pvh.c: Updated
	* mailbox/argp-xinl.c: Updated
	* mailbox/argp.h: Updated
	* mailbox/asnprintf.c: Updated
	* mailbox/fnmatch.c: Added to the repository
	* mailbox/fnmatch_.h: Added to the repository
	* mailbox/fnmatch_loop.c: Added to the repository
	* mailbox/getdelim.c: Updated
	* mailbox/getdelim.h: Updated
	* mailbox/getline.c: Updated
	* mailbox/getline.h: Updated
	* mailbox/getlogin_r.c: Added to the repository
	* mailbox/getlogin_r.h: Added to the repository
	* mailbox/getopt.c: Updated
	* mailbox/getopt1.c: Updated
	* mailbox/getopt_.h: Updated
	* mailbox/getopt_int.h: Updated
	* mailbox/gettext.h: Updated
	* mailbox/glob-libc.h: Added to the repository
	* mailbox/glob.c: Added to the repository
	* mailbox/glob_.h: Added to the repository
	* mailbox/malloc.c: Added to the repository
	* mailbox/mbchar.c: Updated
	* mailbox/mbchar.h: Updated
	* mailbox/mbuiter.h: Added to the repository
	* mailbox/md5.c: Updated
	* mailbox/md5.h: Updated
	* mailbox/memchr.c: Updated
	* mailbox/mempcpy.c: Updated
	* mailbox/mempcpy.h: Updated
	* mailbox/minmax.h: Updated
	* mailbox/printf-args.c: Updated
	* mailbox/printf-args.h: Updated
	* mailbox/printf-parse.c: Updated
	* mailbox/printf-parse.h: Updated
	* mailbox/regcomp.c: Updated
	* mailbox/regex.c: Updated
	* mailbox/regex.h: Updated
	* mailbox/regex_internal.c: Updated
	* mailbox/regex_internal.h: Updated
	* mailbox/regexec.c: Updated
	* mailbox/size_max.h: Updated
	* mailbox/stat-macros.h: Added to the repository
	* mailbox/stdbool_.h: Updated
	* mailbox/stdint_.h: Added to the repository
	* mailbox/strcase.h: Updated
	* mailbox/strcasecmp.c: Updated
	* mailbox/strchrnul.c: Updated
	* mailbox/strchrnul.h: Updated
	* mailbox/strdup.c: Added to the repository
	* mailbox/strdup.h: Added to the repository
	* mailbox/strncasecmp.c: Updated
	* mailbox/strndup.c: Updated
	* mailbox/strndup.h: Updated
	* mailbox/strnlen.c: Updated
	* mailbox/strnlen.h: Updated
	* mailbox/strnlen1.c: Updated
	* mailbox/strnlen1.h: Updated
	* mailbox/strtok_r.c: Updated
	* mailbox/strtok_r.h: Updated
	* mailbox/sysexit_.h: Updated
	* mailbox/vasnprintf.c: Updated
	* mailbox/vasnprintf.h: Updated
	* mailbox/vsnprintf.c: Updated
	* mailbox/vsnprintf.h: Updated
	* mailbox/xsize.h: Updated

	* examples/argcv.c: Add missing includes
	* examples/mailcap.c: Likewise
	* examples/url-parse.c: Likewise
	* mail/send.c: Likewise
	* mailbox/list.c: Likewise
	* mh/mh_alias.l: Likewise
	* mimeview/mimetypes.l: Likewise
	* examples/nntpclient.c: Add missing forward declarations

	* libsieve/sieve.h (mu_sieve_yylex,mu_sieve_yyerror): Add
	declarations.
	* libsieve/sieve.y (yylex,yyerror): Remove declarations
	* include/mailutils/mutil.h (mu_is_proto): New function.
	* mailbox/mutil.c: Likewise
	* mailbox/mbx_default.c (is_proto): Replace by mu_is_proto. All
	callers updated
	* mailbox/mailbox.c (mailbox_folder_create): Do not try to select
	previous level if given a protocol spec, other than `file:'

	* mh/mh.h (mh_file_to_message): Change signature
	* mh/mh_init.c: Likewise
	* mimeview/Makefile.am (AM_CPPFLAGS): Add -D_GNU_SOURCE=1, needed
	for compiling lex sources
	* mh/Makefile.am: Likewise
	
2005-11-14  Sergey Poznyakoff  <gray@gnu.org.ua>

	* examples/argcv.c: Include <mailutils/error.h>
	* examples/base64.c: Include <config.h>
	* readmsg/readmsg.h: Likewise
	* mail/z.c (z_parse_args): change tyoe of return_count
	(mail_z): Change type of count to off_t
	* include/mailutils/stream.h: Fix indentation

	* scripts/gnulib-sync: Replace AC_LIBSOURCE with MU_LIBSOURCE
	
2005-11-14  Sergey Poznyakoff  <gray@gnu.org.ua>

        * examples/argcv.c: Include <mailutils/error.h>
        * examples/base64.c: Include <config.h>
        * readmsg/readmsg.h: Likewise
        * mail/z.c (z_parse_args): change type of return_count
        (mail_z): Change type of count to off_t
        * include/mailutils/stream.h: Fix indentation
	* mailbox/file_stream.c (struct _fise_stream.offset): Change type
	to off_t
	
2005-11-12  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac (AUTHLIBS,AUTHLIBS_DEPENDENCY,AUTHINCS): Prefixed
	with MU_
	* mail/msgset.y (check_set): Was displaying `inappropriate message'
	diagnostics if the first message from the set was deleted. Fixed.
	* mail/util.c, mailbox/registrar.c: Add typecasts
	* mh/mh.h: Add includes needed for W.*() macros
	* comsat/Makefile.am, config/Makefile.am, examples/Makefile.am,
	frm/Makefile.am, guimb/Makefile.am, imap4d/Makefile.am,
	libmu_scm/Makefile.am, libsieve/Makefile.am, mail/Makefile.am, 
	mail.local/Makefile.am, mail.remote/Makefile.am,
	mailbox/Makefile.am, messages/Makefile.am, mh/Makefile.am,
	movemail/Makefile.am, pop3d/Makefile.am, readmsg/Makefile.am,
	sieve/Makefile.am: Load MU_AUTHLIBS before libmailutils. Fixes
	cygwin build.

2005-11-09  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: Somewhat reluctantly append $(EXEEXT) to popauth
	binary name to fix cygwin builds.
	* mail.remote/Makefile.am (PROGRAMS_SMTP): Likewise
	* mh/Makefile.am (PROGRAMS_MH): Likewise

2005-11-07  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac (GUIMB): Fix assignment to work on cygwin too
	* THANKS: Add D. J. Henman

2005-11-03  Sergey Poznyakoff  <gray@gnu.org.ua>

	* comsat/Makefile.am, dotlock/Makefile.am, examples/Makefile.am,
	frm/Makefile.am, guimb/Makefile.am, imap4d/Makefile.am,
	mail.local/Makefile.am, mail.remote/Makefile.am, mapi/Makefile.am,
	messages/Makefile.am, mh/Makefile.am, movemail/Makefile.am,
	pop3d/Makefile.am, readmsg/Makefile.am, sieve/Makefile.am: Load
	libmuauth before libmailutils.  

2005-11-02  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: Fix typo
	* comsat/comsat.c: Fix typo in the comment

2005-11-01  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libsieve/sieve.l (pop_source): Clear sieve_filename if
	context_stack is empty.

2005-10-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* Makefile.am (release): Rename to alpha
	(alphacheck): New rule
	* configure.ac: Always define program_name to
	program_invocation_name

	* libsieve/actions.c (build_mime): Split into three smaller
	functions, each for its own task.
	Add Content-Type,Content-Transfer-Encoding headers to the
	DSN. Proposed by Kostas Zorbadelos. 
	* sieve/testsuite/Reject: Updated to match the above changes	
	* sieve/testsuite/sieve/reject.exp: Updated
	* examples/http.c: Include <sys/time.h>
	* mailbox/imap/folder.c (imap_writeline): Fix handling of input
	lines longer than 254 chars. Proposed by Daniel Kahn Gillmor.
	* THANKS: Add Kostas Zorbadelos and Daniel Kahn Gillmor.	

2005-10-30  Sergey Poznyakoff  <gray@gnu.org.ua>

	* NEWS: Updated
	* include/mailutils/compat.h: New file. Compatibility defines for
	programs using mailutils interface version 0:0:0.
	* include/mailutils/Makefile.am (pkginclude_HEADERS): Add compat.h
	* include/mailutils/folder.h (mu_0_6_folder_list)
	(mu_0_6_folder_lsub,mu_0_6_folder_list_destroy): Compatibility
	functions.
	* include/mailutils/mailutils.h: Include compat.h, if required
	* include/mailutils/message.h (message_unref): Rename to
	mu_message_unref. All callers updated
	* include/mailutils/mime.h (MIME_INCREAMENTAL_PARSER): Remove
	(MIME_MULTIPART_MIXED,MIME_MULTIPART_ALT): Prefix with MU_. All
	uses changed.
	* include/mailutils/monitor.h (struct mu__monitor): Rename to
	mu_monitor. All uses changed.
	* include/mailutils/registrar.h (struct _mu_record): Fix member
	names. All uses changed
	* include/mailutils/sql.h (rdl_init_t,rdl_done_t): Prefix with mu_
	* mail/util.c (util_do_command): Minor fix
	
	* libsieve/actions.c,libsieve/extensions/vacation.c,
	mailbox/filter.c, mailbox/folder.c, mailbox/mime.c,
	mailbox/registrar.c, mailbox/rfc2047.c, mh/mhl.c, mh/mhn.c: Synch
	with the above changes.

	* mail/if.c (mail_if): Fix 'r' condition
	(mail_else): Fix handling of nested ifs
	* mail/mail.c: New option --exec (-E)
	(mail_cmdline): Invalidate the page when a new mail arrives
	(main): Fix handling of modes.
	* mail/quit.c (mail_mbox_close): mbox can be NULL (e.g.
	--exec=quit was given)
	* mail/util.c (util_do_command): Accept traditional contracted
	forms (`d*', `p9')
	Fix bug in handling conditional branches (bug introduced on
	2005-08-11).
	* mail/testsuite/if.mail: New test script.
	* mail/testsuite/Makefile.am (EXTRA_DIST): Add if.mail
	* mail/testsuite/mail/if.exp: New test case.
	* mail/testsuite/mail/DISTFILES: Add if.exp

2005-10-28  Sergey Poznyakoff  <gray@gnu.org.ua>

	* examples/argcv.c: Include config.h

2005-10-17  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: New option --without-fribidi allows to disable
	fribidi support.
	Check for FRIBIDI_CHARSET_CAP_RTL vs. FRIBIDI_CHAR_SET_CAP_RTL.
	* README: Updated
	
2005-09-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* examples/decode2047.c: Allow to specify charset from the command
	line.
	* examples/encode2047.c: Allow to specify charset and encoding
	from the command line.
	* include/mailutils/filter.h (mu_rfc_2047_B_filter): New filter.
	* include/mailutils/libsieve.h (MU_SIEVE_CHARSET): New define
	* libsieve/extensions/vacation.c: Implemented :mime. Correctly
	handle subject line, no matter what the charset is.
	Fixed bug in creating `References:' header.

	* mailbox/filter.c (mu_filter_get_list): Add mu_rfc_2047_B_filter
	* mailbox/filter_trans.c (mu_rfc_2047_B_filter): New filter. Alias
	to base64.
	
	* include/mailutils/iterator.h: Minor stylistic changes
	* mailbox/iterator.c: Likewise
	* mailbox/wicket.c: Likewise
	* mh/mhn.c: Likewise
	
2005-09-22  Sergey Poznyakoff  <gray@gnu.org.ua>

	* NEWS: Minor wording change.
	* config/mailutils-config.c: New command line argument "sieve".

2005-09-19  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mailbox/imap/mbox.c (delete_to_string): Make sure the message
	set does not end with a comma. Bug reported by Gerd Flaig
	(<gefla@pond.sub.org>), I suppose.

2005-09-17  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mh/send.c (expand_aliases): Use mh_expand_aliases

	* mh/forw.c,mh/repl.c: Implemented --annotate

	* mh/mh_init.c (mh_quote,mh_expand_aliases): New functions
	* mh/mh.h (mh_quote,mh_expand_aliases): New functions
	(struct mh_whatnow_env): New fields to support annotation.
	* mh/mh_whatnow.c: Support message annotation. Improved error
	reporting after launching external programs.
	
	* mh/anno.c (main): Make the first annotated message current. 
	(opt_handler): Quote --text argument, if necessary.

	* mh/TODO: Updated
	
2005-09-14  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mail/page.c (cond_page_invalidate,page_move): Bugfix.

2005-09-09  Sergey Poznyakoff  <gray@gnu.org.ua>

	* imap4d/search.c (imap4d_search): Fix potential vulnerability:
	pass format string as a third argument to util_finish
	* imap4d/copy.c, imap4d/fetch.c, imap4d/store.c: Always pass
	format string as a third argument to util_finish. Although this is not
	necessary, since 'buffer' is guaranteed to contain a normal error
	string, without format specifiers, yet this will simplify maintainence.

2005-08-31  Sergey Poznyakoff  <gray@gnu.org.ua>

	* examples/lsf.c: New test program. List folders
	* examples/Makefile.am: Add lsf
	* mailbox/imap/folder.c (guess_level,list_copy): Fixed
	(imap_parse): Handle NO case explicitely.
	* mailbox/mbox/folder.c: Minor fix.

2005-08-30  Sergey Poznyakoff  <gray@gnu.org.ua>

	Remove obsolete usage of mu_folder_list (ex. folder_list). It
	seems to have been introduced when mu_list_t (ex. list_t) has
	not yet been there. All callers updated. Mbox format
	implementation has been tested. Imap format one is being tested. 
	
	* include/mailutils/folder.h (struct mu_list_response.level): New
	member
	(struct mu_folder_list): Removed. Use mu_list_t instead
	(mu_folder_list): Use mu_list_t. Take an extra argument: a maximum
	recusion level.
	(mu_folder_lsub): Change typo of the last argument (mu_list_t
	now).
	(mu_folder_list_destroy): Removed
	(mu_list_response_free): New function
	* lib/mu_asprintf.h: Remove vestiges of __P(). Define _GNU_SOURCE,
	if not alrerady defined.

	* mailbox/imap/folder.c: Rewritten for new
	mu_folder_list,mu_folder_lsub semantics.  
	* mailbox/imap/mbox.c: Likewise
	* mailbox/include/folder0.h: Likewise.
	* mailbox/include/imap0.h: Likewise.
	* mailbox/mbox/folder.c: Likewise.
	* mailbox/nntp/folder.c: Likewise.
	* mail/mailline.c: Use new mu_folder_list
	* mailbox/folder.c: Likewise.

	* auth/radius.c: Updated for recent libgnuradius 

	* mh/folder.c: Implement --pack, --verbose, --dry-run (just in case).
	* mh/TODO: Updated
	* mh/inc.c: Minor bugfixes.
	* mh/mark.c: Likewise
	* mh/mh.h (mh_context_iterator): Changed signature
	* mh/mh_ctx.c (mh_context_iterate): Bugfix
	* mh/mh_getopt.h (ARG_PACK): New define

2005-08-29  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: Raise version number to 0.6.92
	Raise library current interface version to 1
	* NEWS: Updated
	
	* include/mailutils/filter.h,
	include/mailutils/registrar.h, include/mailutils/types.h,
	mailbox/filter.c, mailbox/filter_rfc822.c, mailbox/filter_trans.c,
	mailbox/folder.c, mailbox/getopt.h, mailbox/locker.c,
	mailbox/parse822.c, mailbox/registrar.c, mailbox/sendmail.c,
	mailbox/smtp.c, mailbox/url.c, mailbox/imap/folder.c,
	mailbox/include/address0.h, mailbox/include/attribute0.h,
	mailbox/include/auth0.h, mailbox/include/body0.h,
	mailbox/include/debug0.h, mailbox/include/envelope0.h,
	mailbox/include/filter0.h, mailbox/include/folder0.h,
	mailbox/include/header0.h, mailbox/include/iterator0.h,
	mailbox/include/list0.h, mailbox/include/mailbox0.h,
	mailbox/include/mailer0.h, mailbox/include/message0.h,
	mailbox/include/mime0.h, mailbox/include/observer0.h,
	mailbox/include/property0.h, mailbox/include/stream0.h,
	mailbox/include/url0.h, mailbox/maildir/folder.c,
	mailbox/mbox/folder.c, mailbox/mh/folder.c, mailbox/nntp/folder.c,
	mailbox/pop/folder.c: Fix-up structure names from types.h

	Final seasoning: Replace munre_ with mu_unre_
	
	* include/mailutils/mutil.h
	* libsieve/extensions/vacation.c
	* mail/followup.c
	* mail/reply.c
	* mail/util.c
	* mailbox/munre.c
	* mh/mh_format.c
	* mh/mh_init.c

2005-08-27  Wojciech Polak

	Normalize global namespace. Part 2: Symbols defined in header files
	mailer.h, message.h, mime.h, monitor.h, observer.h, parse822.h,
	property.h, registrar.h, stream.h, tls.h, types.h, url.h.

	Files affected:

	* auth/gsasl.c, auth/tls.c, comsat/action.c, comsat/comsat.c,
	comsat/comsat.h, dotlock/dotlock.c, examples/addr.c,
	examples/base64.c, examples/decode2047.c, examples/encode2047.c,
	examples/http.c, examples/iconv.c, examples/listop.c,
	examples/mailcap.c, examples/mimetest.c, examples/msg-send.c,
	examples/mta.c, examples/murun.c, examples/nntpclient.c,
	examples/numaddr.c, examples/pop3client.c, examples/sfrom.c,
	examples/url-parse.c, frm/common.c, frm/frm.c, frm/frm.h,
	frm/from.c, guimb/collect.c, guimb/guimb.h, guimb/util.c,
	imap4d/append.c, imap4d/auth_gsasl.c, imap4d/authenticate.c,
	imap4d/capability.c, imap4d/copy.c, imap4d/fetch.c, imap4d/imap4d.c,
	imap4d/imap4d.h, imap4d/rename.c, imap4d/search.c, imap4d/status.c,
	imap4d/store.c, imap4d/sync.c, imap4d/util.c,
	include/mailutils/address.h, include/mailutils/attribute.h,
	include/mailutils/auth.h, include/mailutils/body.h,
	include/mailutils/envelope.h, include/mailutils/filter.h,
	include/mailutils/folder.h, include/mailutils/gsasl.h,
	include/mailutils/guile.h, include/mailutils/header.h,
	include/mailutils/iterator.h, include/mailutils/libsieve.h,
	include/mailutils/list.h, include/mailutils/locker.h,
	include/mailutils/mailbox.h, include/mailutils/mailcap.h,
	include/mailutils/mailer.h, include/mailutils/message.h,
	include/mailutils/mime.h, include/mailutils/monitor.h,
	include/mailutils/mu_auth.h, include/mailutils/mutil.h,
	include/mailutils/nntp.h, include/mailutils/observer.h,
	include/mailutils/parse822.h, include/mailutils/pop3.h,
	include/mailutils/property.h, include/mailutils/refcount.h,
	include/mailutils/registrar.h, include/mailutils/stream.h,
	include/mailutils/tls.h, include/mailutils/types.h,
	include/mailutils/url.h, include/mailutils/sys/nntp.h,
	include/mailutils/sys/pop3.h, lib/mailcap.c, libmu_scm/mu_address.c,
	libmu_scm/mu_body.c, libmu_scm/mu_mailbox.c, libmu_scm/mu_message.c,
	libmu_scm/mu_mime.c, libmu_scm/mu_port.c, libmu_scm/mu_scm.c,
	libsieve/actions.c, libsieve/argp.c, libsieve/comparator.c,
	libsieve/load.c, libsieve/prog.c, libsieve/register.c,
	libsieve/relational.c, libsieve/require.c, libsieve/runtime.c,
	libsieve/sieve.h, libsieve/sieve.l, libsieve/sieve.y, libsieve/tests.c,
	libsieve/util.c, libsieve/extensions/list.c, libsieve/extensions/spamd.c,
	libsieve/extensions/timestamp.c, libsieve/extensions/vacation.c,
	mail/alias.c, mail/alt.c, mail/copy.c, mail/decode.c, mail/delete.c,
	mail/edit.c, mail/escape.c, mail/file.c, mail/followup.c, mail/from.c,
	mail/hold.c, mail/mail.c, mail/mail.h, mail/mailline.c, mail/mbox.c,
	mail/msgset.y, mail/next.c, mail/page.c, mail/pipe.c, mail/previous.c,
	mail/print.c, mail/quit.c, mail/reply.c, mail/retain.c, mail/send.c,
	mail/size.c, mail/summary.c, mail/tag.c, mail/top.c, mail/touch.c,
	mail/undelete.c, mail/util.c, mail/visual.c, mail/write.c,
	mail.local/mail.local.h, mail.local/main.c, mail.local/script.c,
	mail.remote/mail.remote.c, mailbox/address.c, mailbox/amd.c,
	mailbox/attachment.c, mailbox/attribute.c, mailbox/auth.c,
	mailbox/body.c, mailbox/envelope.c, mailbox/file_stream.c,
	mailbox/filter.c, mailbox/filter_iconv.c, mailbox/filter_rfc822.c,
	mailbox/filter_trans.c, mailbox/folder.c, mailbox/header.c,
	mailbox/iterator.c, mailbox/list.c, mailbox/locker.c, mailbox/mailbox.c,
	mailbox/mailcap.c, mailbox/mailer.c, mailbox/mapfile_stream.c,
	mailbox/mbx_default.c, mailbox/memory_stream.c, mailbox/message.c,
	mailbox/mime.c, mailbox/monitor.c, mailbox/mu_argp.c, mailbox/mu_auth.c,
	mailbox/mutil.c, mailbox/observer.c, mailbox/parse822.c,
	mailbox/property.c, mailbox/registrar.c, mailbox/rfc2047.c,
	mailbox/sendmail.c, mailbox/smtp.c, mailbox/stream.c, mailbox/tcp.c,
	mailbox/ticket.c, mailbox/url.c, mailbox/url_sendmail.c,
	mailbox/url_smtp.c, mailbox/wicket.c, mailbox/imap/folder.c,
	mailbox/imap/mbox.c, mailbox/imap/url.c, mailbox/include/amd.h,
	mailbox/include/attribute0.h, mailbox/include/auth0.h,
	mailbox/include/body0.h, mailbox/include/envelope0.h,
	mailbox/include/filter0.h, mailbox/include/folder0.h,
	mailbox/include/header0.h, mailbox/include/imap0.h,
	mailbox/include/iterator0.h, mailbox/include/list0.h,
	mailbox/include/mailbox0.h, mailbox/include/mailer0.h,
	mailbox/include/message0.h, mailbox/include/mime0.h,
	mailbox/include/observer0.h, mailbox/include/property0.h,
	mailbox/include/registrar0.h, mailbox/include/stream0.h,
	mailbox/include/url0.h, mailbox/maildir/folder.c, mailbox/maildir/mbox.c,
	mailbox/mbox/folder.c, mailbox/mbox/mbox.c, mailbox/mbox/mbox0.h,
	mailbox/mbox/mboxscan.c, mailbox/mbox/url.c, mailbox/mh/folder.c,
	mailbox/mh/mbox.c, mailbox/nntp/folder.c, mailbox/nntp/mbox.c,
	mailbox/nntp/nntp0.h, mailbox/nntp/nntp_article.c,
	mailbox/nntp/nntp_body.c, mailbox/nntp/nntp_carrier.c,
	mailbox/nntp/nntp_connect.c, mailbox/nntp/nntp_destroy.c,
	mailbox/nntp/nntp_disconnect.c, mailbox/nntp/nntp_head.c,
	mailbox/nntp/nntp_help.c, mailbox/nntp/nntp_ihave.c,
	mailbox/nntp/nntp_iterator.c, mailbox/nntp/nntp_list_active.c,
	mailbox/nntp/nntp_list_distribpats.c,
	mailbox/nntp/nntp_list_distributions.c,
	mailbox/nntp/nntp_list_extensions.c, mailbox/nntp/nntp_list_newsgroups.c,
	mailbox/nntp/nntp_list_times.c, mailbox/nntp/nntp_newgroups.c,
	mailbox/nntp/nntp_newnews.c, mailbox/nntp/nntp_post.c,
	mailbox/nntp/nntp_readline.c, mailbox/nntp/nntp_sendline.c,
	mailbox/nntp/nntp_stream.c, mailbox/nntp/url.c, mailbox/pop/folder.c,
	mailbox/pop/mbox.c, mailbox/pop/pop3_capa.c, mailbox/pop/pop3_carrier.c,
	mailbox/pop/pop3_connect.c, mailbox/pop/pop3_destroy.c,
	mailbox/pop/pop3_disconnect.c, mailbox/pop/pop3_iterator.c,
	mailbox/pop/pop3_lista.c, mailbox/pop/pop3_readline.c,
	mailbox/pop/pop3_retr.c, mailbox/pop/pop3_sendline.c,
	mailbox/pop/pop3_stls.c, mailbox/pop/pop3_stream.c,
	mailbox/pop/pop3_top.c, mailbox/pop/pop3_uidla.c, mailbox/pop/url.c,
	messages/messages.c, mh/ali.c, mh/anno.c, mh/comp.c, mh/compcommon.c,
	mh/folder.c, mh/forw.c, mh/inc.c, mh/mark.c, mh/mh.h, mh/mh_alias.y,
	mh/mh_ctx.c, mh/mh_format.c, mh/mh_init.c, mh/mh_list.c, mh/mh_msgset.c,
	mh/mh_stream.c, mh/mh_whatnow.c, mh/mh_whom.c, mh/mhl.c, mh/mhn.c,
	mh/mhpath.c, mh/pick.c, mh/pick.h, mh/pick.y, mh/refile.c, mh/repl.c,
	mh/rmf.c, mh/rmm.c, mh/scan.c, mh/send.c, mh/sortm.c,
	mimeview/mimetypes.y, mimeview/mimeview.c, movemail/movemail.c,
	pop3d/apop.c, pop3d/dele.c, pop3d/expire.c, pop3d/extra.c, pop3d/list.c,
	pop3d/lock.c, pop3d/pop3d.c, pop3d/pop3d.h, pop3d/quit.c, pop3d/retr.c,
	pop3d/rset.c, pop3d/stat.c, pop3d/top.c, pop3d/uidl.c, pop3d/user.c,
	readmsg/msglist.c, readmsg/readmsg.c, readmsg/readmsg.h, sieve/sieve.c,
	sql/odbc.c.
	
2005-08-26  Sergey Poznyakoff  <gray@gnu.org.ua>

	Normalize global namespace. All exportable symbols begin with mu_.
	Part 1: Symbols defined in header files address.h, argcv.h,
	attribute.h, auth.h, body.h, daemon.h, debug.h, envelope.h,
	errno.h, error.h, filter.h, folder.h, gsasl.h, guile.h, header.h,
	iterator.h, libsieve.h, list.h,	locker.h, mailbox.h.
	
	Files affected:
	
	* configure.ac, auth/gsasl.c, auth/radius.c, comsat/action.c,
	comsat/cfg.c, comsat/comsat.c, dotlock/dotlock.c, examples/addr.c,
	examples/argcv.c, examples/base64.c, examples/iconv.c,
	examples/listop.c, examples/mimetest.c, examples/msg-send.c,
	examples/mta.c, examples/murun.c, examples/nntpclient.c,
	examples/numaddr.c, examples/pop3client.c, examples/sfrom.c,
	frm/common.c, frm/frm.c, frm/from.c, guimb/collect.c,
	guimb/main.c, guimb/util.c, imap4d/append.c, imap4d/auth_gsasl.c,
	imap4d/authenticate.c, imap4d/bye.c, imap4d/capability.c,
	imap4d/close.c, imap4d/copy.c, imap4d/expunge.c, imap4d/fetch.c,
	imap4d/imap4d.c, imap4d/imap4d.h, imap4d/rename.c,
	imap4d/search.c, imap4d/select.c, imap4d/status.c, imap4d/store.c,
	imap4d/sync.c, imap4d/util.c, include/mailutils/address.h,
	include/mailutils/argcv.h, include/mailutils/attribute.h,
	include/mailutils/auth.h, include/mailutils/body.h,
	include/mailutils/daemon.h, include/mailutils/envelope.h,
	include/mailutils/error.h, include/mailutils/filter.h,
	include/mailutils/folder.h, include/mailutils/gsasl.h,
	include/mailutils/guile.h, include/mailutils/header.h,
	include/mailutils/iterator.h, include/mailutils/libsieve.h,
	include/mailutils/list.h, include/mailutils/locker.h,
	include/mailutils/mailbox.h, include/mailutils/nntp.h,
	include/mailutils/pop3.h, include/mailutils/types.h,
	lib/mailcap.c, libmu_scm/mu_address.c, libmu_scm/mu_body.c,
	libmu_scm/mu_guimb.c, libmu_scm/mu_logger.c,
	libmu_scm/mu_mailbox.c, libmu_scm/mu_message.c,
	libmu_scm/mu_mime.c, libmu_scm/mu_scm.c, libmu_scm/mu_util.c,
	libsieve/Makefile.am, libsieve/actions.c, libsieve/argp.c,
	libsieve/comparator.c, libsieve/load.c, libsieve/prog.c,
	libsieve/register.c, libsieve/relational.c, libsieve/require.c,
	libsieve/runtime.c, libsieve/sieve.h, libsieve/sieve.l,
	libsieve/sieve.y, libsieve/tests.c, libsieve/util.c,
	libsieve/extensions/list.c, libsieve/extensions/spamd.c,
	libsieve/extensions/timestamp.c, libsieve/extensions/vacation.c,
	m4/longdouble.m4, m4/signed.m4, m4/size_max.m4, m4/wchar_t.m4,
	m4/wint_t.m4, m4/xsize.m4, mail/alias.c, mail/copy.c,
	mail/decode.c, mail/delete.c, mail/escape.c, mail/exit.c,
	mail/file.c, mail/followup.c, mail/from.c, mail/hold.c,
	mail/inc.c, mail/mail.c, mail/mailline.c, mail/mbox.c,
	mail/msgset.y, mail/next.c, mail/page.c, mail/print.c,
	mail/quit.c, mail/reply.c, mail/retain.c, mail/send.c,
	mail/shell.c, mail/summary.c, mail/tag.c, mail/touch.c,
	mail/undelete.c, mail/util.c, mail/write.c, mail.local/main.c,
	mail.local/script.c, mail.remote/mail.remote.c,
	mailbox/Makefile.am, mailbox/address.c, mailbox/amd.c,
	mailbox/argcv.c, mailbox/attachment.c, mailbox/attribute.c,
	mailbox/auth.c, mailbox/body.c, mailbox/daemon.c,
	mailbox/envelope.c, mailbox/file_stream.c, mailbox/filter.c,
	mailbox/filter_iconv.c, mailbox/filter_rfc822.c,
	mailbox/filter_trans.c, mailbox/folder.c, mailbox/header.c,
	mailbox/iterator.c, mailbox/list.c, mailbox/locker.c,
	mailbox/mailbox.c, mailbox/mailer.c, mailbox/mbx_default.c,
	mailbox/message.c, mailbox/mime.c, mailbox/mu_argp.c,
	mailbox/mu_auth.c, mailbox/muerror.c, mailbox/mutil.c,
	mailbox/observer.c, mailbox/parse822.c, mailbox/registrar.c,
	mailbox/rfc2047.c, mailbox/sendmail.c, mailbox/smtp.c,
	mailbox/ticket.c, mailbox/wicket.c, mailbox/imap/Makefile.am,
	mailbox/imap/folder.c, mailbox/imap/mbox.c, mailbox/include/amd.h,
	mailbox/include/folder0.h, mailbox/include/imap0.h,
	mailbox/include/list0.h, mailbox/include/mime0.h,
	mailbox/maildir/Makefile.am, mailbox/maildir/mbox.c,
	mailbox/mbox/Makefile.am, mailbox/mbox/folder.c,
	mailbox/mbox/mbox.c, mailbox/mbox/mboxscan.c,
	mailbox/mh/Makefile.am, mailbox/mh/folder.c, mailbox/mh/mbox.c,
	mailbox/nntp/Makefile.am, mailbox/nntp/folder.c,
	mailbox/nntp/mbox.c, mailbox/nntp/nntp_iterator.c,
	mailbox/nntp/nntp_list_active.c,
	mailbox/nntp/nntp_list_distribpats.c,
	mailbox/nntp/nntp_list_distributions.c,
	mailbox/nntp/nntp_list_extensions.c,
	mailbox/nntp/nntp_list_newsgroups.c,
	mailbox/nntp/nntp_list_times.c, mailbox/pop/Makefile.am,
	mailbox/pop/folder.c, mailbox/pop/mbox.c, mailbox/pop/pop3_capa.c,
	mailbox/pop/pop3_iterator.c, messages/messages.c, mh/ali.c,
	mh/anno.c, mh/comp.c, mh/folder.c, mh/forw.c, mh/inc.c, mh/mark.c,
	mh/mh_alias.y, mh/mh_argp.c, mh/mh_ctx.c, mh/mh_format.c,
	mh/mh_init.c, mh/mh_list.c, mh/mh_msgset.c, mh/mh_sequence.c,
	mh/mh_stream.c, mh/mh_whatnow.c, mh/mh_whom.c, mh/mhn.c,
	mh/mhpath.c, mh/pick.c, mh/pick.y, mh/refile.c, mh/repl.c,
	mh/rmf.c, mh/rmm.c, mh/scan.c, mh/send.c, mh/sortm.c,
	mimeview/mimetypes.y, mimeview/mimeview.c, movemail/movemail.c,
	pop3d/apop.c, pop3d/dele.c, pop3d/expire.c, pop3d/extra.c,
	pop3d/list.c, pop3d/lock.c, pop3d/pop3d.c, pop3d/popauth.c,
	pop3d/quit.c, pop3d/retr.c, pop3d/rset.c, pop3d/stat.c,
	pop3d/top.c, pop3d/uidl.c, pop3d/user.c, readmsg/msglist.c,
	readmsg/readmsg.c, sieve/sieve.c, sql/odbc.c.

2005-08-24  Sergey Poznyakoff  <gray@gnu.org.ua>

	* scripts/ylwrap: Updated from Radius repository

2005-08-24  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mailbox/testsuite/Makefile.am (EXTRA_DIST): Add Argcv

2005-08-16  Sergey Poznyakoff  <gray@gnu.org.ua>

	* auth/sql.h: Avoid redefinition of _XOPEN_SOURCE
	* mailbox/imap/folder.c: Likewise
	* mailbox/maildir/mbox.c: Likewise
	* mailbox/mbox/mbox0.h: Likewise
	* mailbox/mh/mbox.c: Likewise

	* lib/Makefile.am: Updated
	* mailbox/Makefile.am: Updated
	
	Update by gnulib-sync:

	* lib/allocsa.c: Updated
	* lib/allocsa.h: Updated
	* lib/allocsa.valgrind: Updated
	* lib/asprintf.c: Updated
	* lib/error.c: Updated
	* lib/error.h: Updated
	* lib/exit.h: Updated
	* lib/exitfail.c: Updated
	* lib/exitfail.h: Updated
	* lib/fnmatch.c: Updated
	* lib/fnmatch_.h: Updated
	* lib/fnmatch_loop.c: Updated
	* lib/getpass.c: Updated
	* lib/getpass.h: Updated
	* lib/intprops.h: Added to the repository
	* lib/malloc.c: Updated
	* lib/mbswidth.c: Updated
	* lib/mbswidth.h: Updated
	* lib/obstack.c: Updated
	* lib/obstack.h: Updated
	* lib/realloc.c: Updated
	* lib/setenv.c: Updated
	* lib/setenv.h: Updated
	* lib/snprintf.c: Updated
	* lib/snprintf.h: Updated
	* lib/unsetenv.c: Updated
	* lib/vasprintf.c: Updated
	* lib/vasprintf.h: Updated
	* lib/xalloc-die.c: Added to the repository
	* lib/xalloc.h: Updated
	* lib/xmalloc.c: Updated
	* lib/xsize.h: Updated
	* lib/xstrtol.c: Updated
	* lib/xstrtol.h: Updated
	* lib/xstrtoul.c: Updated
	* m4/alloca.m4: Updated
	* m4/allocsa.m4: Updated
	* m4/argp.m4: Updated
	* m4/eealloc.m4: Updated
	* m4/eoverflow.m4: Updated
	* m4/error.m4: Updated
	* m4/exitfail.m4: Updated
	* m4/extensions.m4: Updated
	* m4/fnmatch.m4: Updated
	* m4/getdelim.m4: Added to the repository
	* m4/getline.m4: Updated
	* m4/getopt.m4: Updated
	* m4/getpass.m4: Updated
	* m4/intmax_t.m4: Updated
	* m4/intmax_t.m4: Updated
	* m4/inttypes_h_gl.m4: Updated
	* m4/inttypes_h_gl.m4: Updated
	* m4/longdouble.m4: Updated
	* m4/longdouble.m4: Updated
	* m4/longlong_gl.m4: Updated
	* m4/longlong_gl.m4: Updated
	* m4/mbchar.m4: Added to the repository
	* m4/mbrtowc.m4: Updated
	* m4/mbrtowc.m4: Updated
	* m4/mbstate_t.m4: Updated
	* m4/mbswidth.m4: Updated
	* m4/md5.m4: Updated
	* m4/memchr.m4: Added to the repository
	* m4/mempcpy.m4: Updated
	* m4/minmax.m4: Added to the repository
	* m4/obstack.m4: Updated
	* m4/onceonly.m4: Updated
	* m4/onceonly.m4: Updated
	* m4/regex.m4: Updated
	* m4/restrict.m4: Updated
	* m4/setenv.m4: Updated
	* m4/signed.m4: Updated
	* m4/size_max.m4: Updated
	* m4/snprintf.m4: Updated
	* m4/stdbool.m4: Updated
	* m4/stdint_h_gl.m4: Updated
	* m4/stdint_h_gl.m4: Updated
	* m4/strcase.m4: Updated
	* m4/strchrnul.m4: Updated
	* m4/strerror_r.m4: Updated
	* m4/strndup.m4: Updated
	* m4/strnlen.m4: Updated
	* m4/strtok_r.m4: Updated
	* m4/sysexits.m4: Updated
	* m4/uint32_t.m4: Updated
	* m4/uintmax_t_gl.m4: Updated
	* m4/ulonglong_gl.m4: Updated
	* m4/unlocked-io.m4: Updated
	* m4/vasnprintf.m4: Updated
	* m4/vasprintf.m4: Updated
	* m4/vsnprintf.m4: Updated
	* m4/wchar_t.m4: Updated
	* m4/wint_t.m4: Updated
	* m4/xalloc.m4: Updated
	* m4/xsize.m4: Updated
	* m4/xsize.m4: Updated
	* m4/xstrtol.m4: Updated
	* mailbox/alloca.c: Updated
	* mailbox/alloca_.h: Updated
	* mailbox/argp-ba.c: Updated
	* mailbox/argp-eexst.c: Updated
	* mailbox/argp-fmtstream.c: Updated
	* mailbox/argp-fmtstream.h: Updated
	* mailbox/argp-fs-xinl.c: Updated
	* mailbox/argp-help.c: Updated
	* mailbox/argp-namefrob.h: Updated
	* mailbox/argp-parse.c: Updated
	* mailbox/argp-pv.c: Updated
	* mailbox/argp-pvh.c: Updated
	* mailbox/argp-xinl.c: Updated
	* mailbox/argp.h: Updated
	* mailbox/asnprintf.c: Updated
	* mailbox/getdelim.c: Added to the repository
	* mailbox/getdelim.h: Added to the repository
	* mailbox/getline.c: Updated
	* mailbox/getline.h: Updated
	* mailbox/getopt.c: Updated
	* mailbox/getopt1.c: Updated
	* mailbox/getopt_.h: Updated
	* mailbox/getopt_int.h: Updated
	* mailbox/gettext.h: Updated
	* mailbox/mbchar.c: Added to the repository
	* mailbox/mbchar.h: Added to the repository
	* mailbox/md5.c: Updated
	* mailbox/md5.h: Updated
	* mailbox/memchr.c: Added to the repository
	* mailbox/mempcpy.c: Updated
	* mailbox/mempcpy.h: Updated
	* mailbox/minmax.h: Updated
	* mailbox/printf-args.c: Updated
	* mailbox/printf-args.h: Updated
	* mailbox/printf-parse.c: Updated
	* mailbox/printf-parse.h: Updated
	* mailbox/regcomp.c: Added to the repository
	* mailbox/regex.c: Updated
	* mailbox/regex.h: Updated
	* mailbox/regex_internal.c: Added to the repository
	* mailbox/regex_internal.h: Added to the repository
	* mailbox/regexec.c: Added to the repository
	* mailbox/size_max.h: Added to the repository
	* mailbox/stdbool_.h: Added to the repository
	* mailbox/strcase.h: Updated
	* mailbox/strcasecmp.c: Updated
	* mailbox/strchrnul.c: Updated
	* mailbox/strchrnul.h: Updated
	* mailbox/strncasecmp.c: Updated
	* mailbox/strndup.c: Updated
	* mailbox/strndup.h: Updated
	* mailbox/strnlen.c: Updated
	* mailbox/strnlen.h: Added to the repository
	* mailbox/strnlen1.c: Added to the repository
	* mailbox/strnlen1.h: Added to the repository
	* mailbox/strtok_r.c: Updated
	* mailbox/strtok_r.h: Updated
	* mailbox/sysexit_.h: Updated
	* mailbox/unlocked-io.h: Updated
	* mailbox/vasnprintf.c: Updated
	* mailbox/vasnprintf.h: Updated
	* mailbox/vsnprintf.c: Updated
	* mailbox/vsnprintf.h: Updated
	* mailbox/xsize.h: Updated

	End of gnulib update
	
	* README-alpha,gnulib.modules,comsat/Makefile.am,
	config/Makefile.am,config/mailutils-config.c,dotlock/Makefile.am,
	examples/Makefile.am,frm/Makefile.am,guimb/Makefile.am,
	imap4d/Makefile.am,lib/.cvsignore,lib/Makefile.am,
	libsieve/extensions/Makefile.am,mail/Makefile.am,
	mail.local/Makefile.am,mail.remote/Makefile.am,
	mailbox/Makefile.am,mailbox/imap/folder.c,mapi/Makefile.am,
	messages/Makefile.am,mh/Makefile.am,mimeview/Makefile.am,
	movemail/Makefile.am,readmsg/Makefile.am,scripts/gnulib-sync,
	sieve/Makefile.am: Rename libmailbox to libmailutils. Rename
	the convenience library (lib/libmailutils) to libmuaux.

	* auth/lbuf.h,comsat/comsat.c,examples/mta.c,guimb/guimb.h,
	imap4d/auth_gsasl.c,imap4d/fetch.c,imap4d/imap4d.c,
	imap4d/imap4d.h,imap4d/list.c,imap4d/namespace.c,imap4d/search.c,
	imap4d/status.c,imap4d/util.c,include/mailutils/address.h,
	include/mailutils/argcv.h,include/mailutils/argp.h,
	include/mailutils/attribute.h,include/mailutils/auth.h,
	include/mailutils/body.h,include/mailutils/daemon.h,
	include/mailutils/debug.h,include/mailutils/envelope.h,
	include/mailutils/error.h,include/mailutils/filter.h,
	include/mailutils/folder.h,include/mailutils/gsasl.h,
	include/mailutils/guile.h,include/mailutils/header.h,
	include/mailutils/iterator.h,include/mailutils/libsieve.h,
	include/mailutils/list.h,include/mailutils/locker.h,
	include/mailutils/mailbox.h,include/mailutils/mailcap.h,
	include/mailutils/mailer.h,include/mailutils/message.h,
	include/mailutils/mime.h,include/mailutils/monitor.h,
	include/mailutils/mu_auth.h,include/mailutils/mutil.h,
	include/mailutils/nls.h,include/mailutils/observer.h,
	include/mailutils/parse822.h,include/mailutils/property.h,
	include/mailutils/refcount.h,include/mailutils/registrar.h,
	include/mailutils/stream.h,include/mailutils/tls.h,
	include/mailutils/types.h,include/mailutils/url.h,lib/md5.h,
	lib/mu_asprintf.h,lib/mu_dbm.h,lib/strsignal.c,
	libmu_scm/mu_address.c,libsieve/argp.c,libsieve/sieve.h,
	libsieve/sieve.l,libsieve/sieve.y,mail/alias.c,mail/decode.c,
	mail/folders.c,mail/mail.c,mail/mail.h,mail/mailline.c,
	mail/msgset.y,mail/send.c,mail/util.c,mail.local/mail.local.h,
	mail.local/main.c,mailbox/amd.c,mailbox/attribute.c,
	mailbox/auth.c,mailbox/body.c,mailbox/debug.c,mailbox/envelope.c,
	mailbox/filter.c,mailbox/filter_rfc822.c,mailbox/filter_trans.c,
	mailbox/folder.c,mailbox/header.c,mailbox/locker.c,
	mailbox/mailbox.c,mailbox/mailer.c,mailbox/message.c,
	mailbox/mu_argp.c,mailbox/mu_auth.c,mailbox/observer.c,
	mailbox/property.c,mailbox/registrar.c,mailbox/stream.c,
	mailbox/ticket.c,mailbox/wicket.c,mailbox/imap/folder.c,
	mailbox/imap/mbox.c,mailbox/include/amd.h,
	mailbox/include/attribute0.h,mailbox/include/auth0.h,
	mailbox/include/debug0.h,mailbox/include/envelope0.h,
	mailbox/include/filter0.h,mailbox/include/folder0.h,
	mailbox/include/header0.h,mailbox/include/imap0.h,
	mailbox/include/list0.h,mailbox/include/mailbox0.h,
	mailbox/include/mailer0.h,mailbox/include/message0.h,
	mailbox/include/observer0.h,mailbox/include/registrar0.h,
	mailbox/include/stream0.h,mailbox/include/url0.h,
	mailbox/maildir/maildir.h,mailbox/mbox/folder.c,
	mailbox/mbox/mbox.c,mailbox/mbox/mbox0.h,mailbox/nntp/folder.c,
	mailbox/nntp/mbox.c,mailbox/nntp/nntp0.h,mh/fmtcheck.c,mh/mh.h,
	mh/mh_alias.l,mh/mh_alias.y,mh/mh_format.c,mh/mh_getopt.h,
	mh/mh_list.c,mh/mh_msgset.c,mh/mhn.c,mh/pick.h,mh/refile.c,
	mh/scan.c,mh/sortm.c,readmsg/readmsg.c,readmsg/readmsg.h,
	sieve/sieve.c,include/mailutils/errno.hin: Remove __P() and
	__PMT() wrappers. 

2005-08-15  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mh/mhn.c (has_nonascii,finish_text_msg): New functions
	(mhn_edit): Use quoted-printable encoding if the text contains
	non-ascii characters.

2005-08-12  Sergey Poznyakoff  <gray@gnu.org.ua>

	* configure.ac: Add -lgnuradius to AUTHLIBS
	* auth/radius.c (mu_radius_argp_parser): Only run init() if radius
	auth is really required.
	(mu_radius_authenticate,mu_auth_radius_user_by_name)
	(mu_auth_radius_user_by_uid): Fail if the module was not
	initialized
	* mail/escape.c: Use strerror uniformly
	
	* mailbox/argcv.c: Make handling of quotes consistent with shell
	rules. In particular, single quotes need not be quoted, and are
	not removed when appearing within a doubly-quoted string.
	* mailbox/testsuite/Argcv: Adapt to the modified argcv.c

	* auth/radius.c: New file. Radius authentication/authorization.
	* auth/Makefile.am (libmuauth_la_SOURCES): Add radius.c. Sorted
	sources alphabetically

	* examples/config/mailutils.dict: New file. 
	* examples/config/Makefile.am (EXTRA_DIST): Add mailutils.dict.
	Sorted files alphabetically
	
	* NEWS: Updated
	* configure.ac: Raised version number to 0.6.91.
	Check for libgnuradius (new option --disable/--enable-radius)
	At the end of configuration display the summary of enabled
	features.

	* include/mailutils/mu_auth.h (mu_auth_radius_module): New module
	(MU_AUTH_REGISTER_ALL_MODULES): Register radius
	* m4/enable.m4 (MU_ENABLE_SUPPORT): Fixed quoting error. Allow
	action-if-true to disable the feature.
	* mailbox/mu_argp.c (mu_conf_option): Reflect radius capability.

	* po/POTFILES.in: Updated

2005-08-11  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mail/var.c: Renamed to ...
	* mail/escape.c: ... to fix a long-standing historical
	inconsistency. 
	(var_shell,var_command,var_help,var_sign,var_bcc) 
	(var_cc,var_deadletter,var_editor,var_print,var_headers)
	(var_insert,var_quote,var_type_input,var_read,var_subj) 
	(var_to,var_visual,var_write,var_exit,var_pipe): Renamed:
	s/var_/escape_/. All callers updated
	* mail/Makefile.am,mail/mail.h,mail/table.c: Likewise

	* include/mailutils/argcv.h (argcv_get_n): New function
	* mailbox/argcv.c: Likewise
	
	* mail/alias.c (alias_iterate_first,alias_iterate_next)
	(alias_iterate_end): New functions for readline completion
	support. 
	* mail/cd.c (mail_cd): Check chdir return value
	* mail/file.c (mail_expand_name): Do not proceed to opening the
	mailbox if failed to get its name
	* mail/help.c (mail_help): Use mail_command_help()
	* mail/list.c (mail_list): Use mail_command_list()
	* mail/mail.h (mail_command_entry): Rewritten
	(mail_escape_entry,struct mail_command): New data type
	(mail_command_table,mail_escape_table): Variables removed
	(util_find_entry): Change prototype
	(util_help,util_command_list)
	(mail_find_command,mail_find_escape,mail_command_help)
	(mail_escape_help,mail_command_list): New functions
	(util_help): Removed
	(alias_iterate_first,alias_iterate_next,alias_iterate_end)
	(var_iterate_first,var_iterate_next,var_iterate_end): New functions
	(file_compl,no_compl,msglist_compl,msglist_file_compl,dir_compl
	(command_compl,alias_compl,var_compl): New functions for readline
	completion support
	* mail/mailline.c (file_compl,no_compl,msglist_compl)
	(msglist_file_compl,dir_compl)
	(command_compl,alias_compl,var_compl): New functions for readline
	completion support
	* mail/send.c: Use mail_find_escape()
	* mail/table.c (mail_command_table,mail_escape_table): Changed
	data type
	(mail_find_command,mail_command_help,mail_command_list)
	(mail_command_name,mail_find_escape,mail_escape_help): New
	functions
	* mail/util.c: Rewritten mail variables support using list_t.
	(util_find_entry,util_help): Rewritten to work with opaque data
	tables
	(util_command_list): New function
	(var_iterate_first,var_iterate_next,var_iterate_end): New
	functions
	(util_folder_path): Convert folder to full name
	* mail/var.c: Use mail_find_command() and mail_escape_help().
	* mailbox/mbox/folder.c (get_pathname): Make sure no extra slash
	is inserted.
	* mailbox/list.c (list_to_array): Bugfix. The counter was not
	incremented.
	
	* po/POTFILES.in: Add mail/cd.c

2005-08-10  Sergey Poznyakoff  <gray@gnu.org.ua>

	* doc/rfc/rfc3501.txt: New file
	* doc/rfc/Makefile.am: Add rfc3501.txt

	* imap4d/copy.c (imap4d_copy0): Minor improvement
	* imap4d/fetch.c (imap4d_fetch0): Ignore non-existing uids instead
	of diagnosing an error. This complies to RFC 3501.
	* imap4d/util.c (util_msgset): For message sets in form X:Y where
	Y is a not-existing UID greater than maximum UID value in the
	mailbox, replace Y with the latter.

	* imap4d/testsuite/imap4d/IDEF0955.exp: Synchronize with the
	recent changes.

2005-07-26  Sergey Poznyakoff  <gray@gnu.org.ua>

	* NEWS: Updated
	
	* examples/mimetest.c: Produce more detailed diagnostics
	* mail/copy.c: Likewise
	* mail/quit.c: Likewise
	* mail/send.c: Likewise
	* mail/page.c (cond_page_invalidate): Bugfix

	* mailbox/errors (MU_READ_ERROR): New error code
	
	* include/mailutils/folder.h: Moved MU_FOLDER_ATTRIBUTE_.* to
	types.h
	* include/mailutils/types.h (MU_FOLDER_ATTRIBUTE_FILE)
	(MU_FOLDER_ATTRIBUTE_DIRECTORY): New defines
	* include/mailutils/registrar.h (_is_scheme, registrar_lookup):
	Take three arguments. All callers updated
	Raised path_record priority to 1000.
	* mailbox/registrar.c: Likewise
	* mailbox/folder.c: Updated calls to registrar_lookup and
	declarations of _is_scheme methods
	* mailbox/mailer.c: Likewise
	* mailbox/maildir/folder.c: Likewise
	* mailbox/mbox/folder.c: Likewise
	* mailbox/mh/folder.c: Likewise
	
	* mailbox/list.c (_insert_item): Bugfix
	* mailbox/testsuite/mailbox/list.exp: New tests
	* mailbox/mailbox.c (mailbox_folder_create): New function
	(mailbox_create): Use mailbox_folder_create.

	* mailbox/rfc2047.c (rfc2047_encode): Bugfix.

	* mail/page.c (page_move): Fix start msg calculation
	
	* include/mailutils/list.h (list_insert): Accept additional
	argument indicating whether to insert item before or after the
	reference one.
	* mailbox/list.c: Likewise
	* examples/listop.c (ins): New option 'before' allows to insert an
	item before another one.
	* mailbox/testsuite/mailbox/list.exp: Test new list operations.
	* mh/mh_alias.y: Updated list_insert invocations
	* mh/mh_format.c (builtin_putnum): Minor fix
	 
	* comsat/comsat.c: Use registrar_record instead of directly
	accessing registrar list.
	* examples/mimetest.c: Likewise
	* examples/msg-send.c: Likewise
	* examples/mta.c: Likewise
	* libmu_scm/mu_scm.c: Likewise
	* mail.local/main.c: Likewise
	* mail.remote/mail.remote.c: Likewise

	* mailbox/registrar.c (registrar_get_list): Split into two
	calls. The registrar_get_list proper is deprecated.
	(registrar_get_iterator,registrar_lookup): New functions
	(registrar_record,unregistrar_record): Use _registrar_get_list

	* mailbox/folder.c (folder_create): Rewritten using
	registrar_lookup()
	* mailbox/mailbox.c (mailbox_create): Likewise
	* mailbox/mailer.c (mailer_create): Likewise

	* mailbox/sendmail.c: Updated declarations of struct _record
	objects.
	* mailbox/smtp.c: Likewise
	* mailbox/imap/folder.c: Likewise
	* mailbox/maildir/folder.c: Likewise
	* mailbox/mbox/folder.c: Likewise
	* mailbox/mh/folder.c: Likewise
	* mailbox/nntp/folder.c: Likewise
	* mailbox/pop/folder.c: Likewise
	
	* include/mailutils/registrar.h (struct _record.priority): New
	member.
	(registrar_get_list): Mark as deprecated
	(registrar_get_iterator,registrar_lookup): New function
	(MU_IMAP_PRIO etc): New defines
	(mu_register_all_mbox_formats,mu_register_local_mbox_formats)
	(mu_register_remote_mbox_formats,mu_register_all_mailer_formats)
	(mu_register_extra_formats): Use registrar_record

	* include/mailutils/types.h: Minor stylistic fix

2005-07-25  Sergey Poznyakoff  <gray@gnu.org.ua>

	* mailbox/locker.c (locker_lock): Allow for non-absolute file
	names. 

2005-07-10  Sergey Poznyakoff  <gray@gnu.org.ua>

	* libsieve/extensions/vacation.c: Unconditionally include mu_dbm.h
	* mailbox/mutil.c (mu_get_homedir): Use EUID to determine user
	identity.

2005-07-08  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* mailbox/mime.c (_mime_get_param): Initialize was_quoted to
	0. Problem reported by Shashank Kavishwar <s_kavishwar@hotmail.com>.
	
2005-07-07  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* libsieve/actions.c: Fall back to "Sender:" and "From:" headers
	(in that order), if the envelope sender is not available.

2005-06-29  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* mailbox/argcv.c (argcv_scan): Improved scanning.
	* mailbox/testsuite/Argcv: New tests

	* mailbox/argcv.c (argcv_scan,argcv_quoted_length)
	(argcv_quote_copy): Fixed handling of unmatched quotes.

2005-06-27  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* include/mailutils/argcv.h (argcv_unescape_char): Renamed to
	argcv_unquote_char
	(argcv_escape_char): Renamed to argcv_quote_char.
	(argcv_quoted_length,argcv_quote_copy): New functions
	* mailbox/argcv.c (argcv_scan,xtonum): Improved parser
	(argcv_unescape_char): Renamed to
	argcv_unquote_char
	(argcv_escape_char): Renamed to argcv_quote_char.
	(argcv_quoted_length,argcv_quote_copy): New functions
	(argcv_unquote_copy): (ex. unescape_copy): Fixed handling of
	escaped sequences.
	(argcv_get,argcv_free,argcv_string): Standardized return value.

	* comsat/action.c: argcv_unescape_char renamed to argcv_unquote_char
	* libsieve/sieve.l: Likewise

	* examples/argcv.c: New file
	* examples/Makefile.am: Add argcv.c

	* mailbox/testsuite/Argcv: New file
	* mailbox/testsuite/mailbox/argcv.exp: New test
	* mailbox/testsuite/mailbox/DISTFILES: Add argcv.exp
	
2005-06-23  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* NEWS: Updated
	* README-alpha: Updated
	* include/mailutils/mailbox.h
	(mu_path_maildir,mu_path_folder_dir): Removed
	(mu_set_mail_directory,mu_set_folder_directory)
	(mu_mail_directory,mu_folder_directory)
	(mu_construct_user_mailbox_url,mailbox_get_flags): New functions.
	* mailbox/mbx_default.c: Likewise.
	* include/mailutils/mutil.h (mu_normalize_maildir): Renamed to
	(mu_normalize_mailbox_url)
	* libmu_scm/mu_mailbox.c (scm_mu_mail_directory)
	(scm_mu_folder_directory): New function
	* libmu_scm/mu_scm.c (_mu_scm_path_maildir)
	(_mu_scm_path_folder_dir): Removed
	
	* auth/sql.c: Use mu_mail_directory, mu_folder_directory and
	related calls.
	* guimb/collect.c: Likewise.
	* mailbox/mu_argp.c: Likewise.
	* mailbox/mutil.c: Likewise.
	* mailbox/system.c: Likewise.
	* mh/comp.c: Likewise.
	* mh/folder.c: Likewise.
	* mh/forw.c: Likewise.
	* mh/mh_init.c: Likewise.
	* mh/mhn.c: Likewise.
	* mh/mhpath.c: Likewise.
	* mh/refile.c: Likewise.
	* mh/repl.c: Likewise.
	* mh/send.c: Likewise.
	* mh/whom.c: Likewise.
	
	* mh/mh.h (mh_global_profile_get): Changed prototype.
	* mh/mh_global.c: Likewise.
	
	* mailbox/imap/mbox.c (imap_messages_count): Use SELECT or EXAMINE
	depending on the mailbox status.
	(imap_expunge): Return EACCES if the mailbox is read-only

	* examples/http.c: Accept up to two arguments: hostname to connect
	to and URL of the page to get.

	* imap4d/close.c: Do not attempt to flush a mailbox opened in
	read-only mode.

	* mail/file.c (mail_file): Invalidate current page map.
	* mail/mail.h: Updated
	* mail/page.c (set_cursor): Use page_move(0) to correctly update
	the map.

	* mailbox/errors (MU_ERR_BAD_FILENAME): New error code.
	* mailbox/mailbox.c (mailbox_get_flags): New function
	
	* imap4d/util.c: Minor correction
	* mail/decode.c: Likewise
	* mail.local/main.c: Likewise
	* frm/from.c: Removed unused variable

2005-06-15  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* examples/mta.c (mta_smtp): Fixed race condition between printing
	the port number, which will be used by the testsuite, and actually
	starting to listen on that port.
	* mail/page.c: New file. Implements an abstract output page.
	* mail/Makefile.am (mail_SOURCES): Add page.c. Alphabetized
	sources.
	
	* mail/delete.c, mail/edit.c, mail/eq.c, mail/file.c,
	mail/followup.c, mail/from.c, mail/headers.c, mail/hold.c,
	mail/mail.c, mail/mailline.c, mail/mbox.c, mail/msgset.y,
	mail/next.c, mail/previous.c, mail/print.c, mail/reply.c,
	mail/size.c, mail/summary.c, mail/top.c, mail/touch.c,
	mail/undelete.c, mail/util.c, mail/visual.c, mail/write.c,
	mail/z.c: Use new pager functions.
	
	* mail/mail.h: New declarations

	* mail/testsuite/mail/z.exp: Fixed tests to match our improved
	output. 

2005-06-13  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* mailbox/amd.c (amd_expunge): Unlink the message file if
	msg_file_name returns NULL.
	* mailbox/maildir/mbox.c (maildir_message_name): Return NULL for
	deleted messages.

	* mailbox/include/stream0.h (struct rbuffer.count): Changed type
	to size_t. Reported by Joseph Caputo <caputo@qedinfo.com>
	* mailbox/stream.c (refill): Removed useless typecast

	* mail/util.c (util_save_outgoing): Rewritten using mailbox
	functions. `set record' can now point to any valid mailbox type.

2005-06-12  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* frm/common.c (get_charset): Make sure output_charset is not NULL.

2005-06-06  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* mailbox/amd.c (amd_envelope_date): Always convert date to ctime
	format. 

2005-05-31  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* mailbox/maildir/mbox.c (maildir_uniq): Fix memory overwrite.

2005-05-27  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* mailbox/amd.c (amd_envelope_date): Reformat Delivery-Date value
	to standart ctime format. Fix memory leak.
	(amd_envelope_sender): Propagate return from header_aget_value()
	back to the caller.
	* mailbox/mbox/mbox.c (restore_sender,restore_date): New
	functions.
	(mbox_append_message0): Use above functions to create sender/date
	values if these are not supplied.
	* movemail/movemail.c (move_message): Fix error diagnostics format.

2005-05-24  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* examples/Makefile.am (noinst_PROGRAMS): Add encode2047. Sorted
	alphabetically.
	* examples/encode2047.c: New file.
	* examples/base64.c (main): Add option -E (encoding). The program
	can now be used to test any encoder/decoder filters, so its name
	is kind of misnomer.
	* mailbox/errors (MU_ERR_BAD_2047_ENCODING): New error code.
	* mailbox/filter_trans.c (qp_encode): Do not keep track of the
	whitespace. Proposed by Amit Jhawar <ajhawar@frontbridge.com>.
	(Q_printable_char_p): TAB is not a printable char.
	(Q_encode): Bugfix: 0x20 is represented by underscore, not vice
	versa.
	* mailbox/rfc2047.c (rfc2047_encode): Bugfix. Use proper encoding
	types. Convert "base64" to "B" and "quoted-printable" to
	"Q". Check return values from stream creation functions. Do not
	destroy input_stream if output_stream was destroyed (prevents
	coredump).
	* scripts/config.rpath: Removed automatically generated file.
	* THANKS: Added Kidong Lee and Amit Jhawar.
	* examples/.cvsignore: Add encode2047. Sort entries.
	
2005-05-23  Kidong Lee  <briankdlee@yahoo.com>

	* mailbox/rfc2047.c (rfc2047_encode): Rewritten using filters
	and streams.

2005-05-23  Sergey Poznyakoff  <gray@Mirddin.farlep.net>
	
	* mailbox/mutil.c: include <sys/select.h>
	* lib/mailcap.c: Provide a replacement for FNM_CASEFOLD
	Reported by Jerry Heyman <heymanj@acm.org>.

	* configure.ac: Compute the value of ULONG_MAX for use in the
	testsute.
	* imap4d/testsuite/Makefile.am (site.exp): Set MU_ULONG_MAX
	* imap4d/testsuite/imap4d/IDEF0955.exp: Compute upper limit for
	the message set spec based on the value of MU_ULONG_MAX.
	* imap4d/testsuite/imap4d/IDEF0956.exp: Likewise

2005-05-20  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* imap4d/fetch.c (fetch_getcommand): Changed proto to make gcc 4.0
	happy. 

2005-05-19  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* auth/sql.c (sql_escape_string): Escape backslashes.
	
	The sources before this point are tagged alpha_0_6_90.

2005-05-17  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* configure.ac: Updated FSF address. Raised version number to
	0.6.90
	
	Updated FSF address:
	
	* COPYING, COPYING.LESSER, Makefile.am, NEWS, 
	auth/Makefile.am, auth/gsasl.c, auth/lbuf.c, auth/lbuf.h,
	auth/pam.c, auth/sql.c, auth/sql.h, auth/tls.c,
	auth/virtual.c, comsat/Makefile.am, comsat/action.c,
	comsat/cfg.c, comsat/comsat.c, comsat/comsat.h,
	config/Makefile.am, config/mailutils-config.c,
	doc/Makefile.am, doc/man/Makefile.am, doc/rfc/Makefile.am,
	doc/texinfo/COPYING.DOC, doc/texinfo/Makefile.am,
	doc/texinfo/fdl.texi, doc/texinfo/mailutils.texi,
	doc/texinfo/muint.texi, dotlock/Makefile.am,
	dotlock/dotlock.c, examples/Makefile.am, examples/addr.c,
	examples/base64.c, examples/decode2047.c, examples/http.c,
	examples/iconv.c, examples/listop.c, examples/mailcap.c,
	examples/mimetest.c, examples/msg-send.c,
	examples/mta.c, examples/muemail.c, examples/murun.c,
	examples/nntpclient.c, examples/numaddr.c,
	examples/pop3client.c, examples/sfrom.c,
	examples/url-parse.c, examples/config/Makefile.am,
	examples/cpp/Makefile.am, examples/scheme/Makefile.am,
	examples/scheme/reply.scm, frm/Makefile.am,
	frm/common.c, frm/frm.c, frm/frm.h, frm/from.c,
	frm/testsuite/Makefile.am, frm/testsuite/frm/test.exp,
	guimb/Makefile.am, guimb/collect.c, guimb/guimb.h,
	guimb/main.c, guimb/util.c, guimb/scm/Makefile.am,
	guimb/scm/mimeheader.scm, guimb/scm/numaddr.scm,
	guimb/scm/redirect.scm, guimb/scm/reject.scm,
	guimb/scm/sieve-core.scm, guimb/scm/sieve.scm.in,
	guimb/scm/vacation.scm, imap4d/Makefile.am,
	imap4d/append.c, imap4d/auth_gsasl.c, imap4d/auth_gss.c,
	imap4d/authenticate.c, imap4d/bye.c, imap4d/capability.c,
	imap4d/check.c, imap4d/close.c, imap4d/commands.c,
	imap4d/copy.c, imap4d/create.c, imap4d/delete.c,
	imap4d/examine.c, imap4d/expunge.c, imap4d/fetch.c,
	imap4d/idle.c, imap4d/imap4d.c, imap4d/imap4d.h,
	imap4d/list.c, imap4d/login.c, imap4d/logout.c,
	imap4d/lsub.c, imap4d/namespace.c, imap4d/noop.c,
	imap4d/rename.c, imap4d/search.c, imap4d/select.c,
	imap4d/signal.c, imap4d/starttls.c, imap4d/status.c,
	imap4d/store.c, imap4d/subscribe.c, imap4d/sync.c,
	imap4d/uid.c, imap4d/unsubscribe.c, imap4d/util.c,
	imap4d/version.c, imap4d/testsuite/Makefile.am,
	imap4d/testsuite/imap4d/IDEF0955.exp,
	imap4d/testsuite/imap4d/IDEF0956.exp,
	imap4d/testsuite/imap4d/anystate.exp,
	imap4d/testsuite/imap4d/append.exp,
	imap4d/testsuite/imap4d/create.exp,
	imap4d/testsuite/imap4d/examine.exp,
	imap4d/testsuite/imap4d/expunge.exp,
	imap4d/testsuite/imap4d/fetch.exp,
	imap4d/testsuite/imap4d/list.exp,
	imap4d/testsuite/imap4d/search.exp,
	imap4d/testsuite/imap4d/x.exp,
	imap4d/testsuite/lib/imap4d.exp,
	include/Makefile.am, include/mailutils/Makefile.am,
	include/mailutils/address.h, include/mailutils/argcv.h,
	include/mailutils/argp.h, include/mailutils/attribute.h,
	include/mailutils/auth.h, include/mailutils/body.h,
	include/mailutils/daemon.h, include/mailutils/debug.h,
	include/mailutils/envelope.h, include/mailutils/errno.hin,
	include/mailutils/error.h, include/mailutils/filter.h,
	include/mailutils/folder.h, include/mailutils/gsasl.h,
	include/mailutils/guile.h, include/mailutils/header.h,
	include/mailutils/iterator.h, include/mailutils/libsieve.h,
	include/mailutils/list.h, include/mailutils/locker.h,
	include/mailutils/mailbox.h, include/mailutils/mailcap.h,
	include/mailutils/mailer.h, include/mailutils/mailutils.h,
	include/mailutils/message.h, include/mailutils/mime.h,
	include/mailutils/monitor.h, include/mailutils/mu_auth.h,
	include/mailutils/mutil.h, include/mailutils/nls.h,
	include/mailutils/nntp.h, include/mailutils/observer.h,
	include/mailutils/parse822.h, include/mailutils/pop3.h,
	include/mailutils/property.h, include/mailutils/refcount.h,
	include/mailutils/registrar.h, include/mailutils/sql.h,
	include/mailutils/stream.h, include/mailutils/tls.h,
	include/mailutils/types.h, include/mailutils/url.h,
	include/mailutils/gnu/Makefile.am,
	include/mailutils/sys/Makefile.am,
	include/mailutils/sys/nntp.h, include/mailutils/sys/pop3.h,
	lib/Makefile.am, lib/allocsa.c, lib/allocsa.h,
	lib/asprintf.c, lib/daemon.c, lib/error.c, lib/error.h,
	lib/exit.h, lib/exitfail.c, lib/exitfail.h,
	lib/fnmatch_.h, lib/fnmatch_loop.c, lib/getpass.c,
	lib/getpass.h, lib/mailcap.c, lib/malloc.c,
	lib/mbswidth.c, lib/mbswidth.h, lib/mu_asprintf.h,
	lib/mu_dbm.c, lib/mu_dbm.h, lib/obstack.c, lib/obstack.h,
	lib/realloc.c, lib/setenv.c, lib/setenv.h, lib/snprintf.c,
	lib/snprintf.h, lib/stdbool_.h, lib/unsetenv.c, lib/utmp.c,
	lib/vasprintf.c, lib/vasprintf.h, lib/xalloc.h,
	lib/xalloc_die.c, lib/xmalloc.c, lib/xsize.h,
	lib/xstrtol.c, lib/xstrtol.h, libmu_scm/Makefile.am,
	libmu_scm/mailutils.scm.in, libmu_scm/mu_address.c,
	libmu_scm/mu_body.c, libmu_scm/mu_guimb.c,
	libmu_scm/mu_logger.c, libmu_scm/mu_mailbox.c,
	libmu_scm/mu_message.c, libmu_scm/mu_mime.c,
	libmu_scm/mu_port.c, libmu_scm/mu_scm.c,
	libmu_scm/mu_scm.h, libmu_scm/mu_util.c,
	libsieve/Makefile.am, libsieve/actions.c, libsieve/argp.c,
	libsieve/comparator.c, libsieve/load.c, libsieve/prog.c,
	libsieve/register.c, libsieve/relational.c,
	libsieve/require.c, libsieve/runtime.c, libsieve/sieve.h,
	libsieve/sieve.l, libsieve/sieve.y, libsieve/tests.c,
	libsieve/util.c, libsieve/extensions/Makefile.am,
	libsieve/extensions/list.c, libsieve/extensions/spamd.c,
	libsieve/extensions/timestamp.c,
	libsieve/extensions/vacation.c, m4/db2.m4, m4/enable.m4,
	m4/gnulib.m4, m4/gsasl.m4, m4/guile.m4, m4/mu_libobj.m4,
	m4/tls.m4, mail/Makefile.am, mail/alias.c,
	mail/alt.c, mail/cd.c, mail/copy.c, mail/decode.c,
	mail/delete.c, mail/dp.c, mail/echo.c, mail/edit.c,
	mail/eq.c, mail/exit.c, mail/file.c, mail/folders.c,
	mail/followup.c, mail/from.c, mail/headers.c, mail/help.c,
	mail/hold.c, mail/if.c, mail/inc.c, mail/list.c,
	mail/mail.c, mail/mail.h, mail/mailline.c, mail/mbox.c,
	mail/msgset.y, mail/next.c, mail/pipe.c, mail/previous.c,
	mail/print.c, mail/quit.c, mail/reply.c, mail/retain.c,
	mail/save.c, mail/send.c, mail/set.c, mail/setenv.c,
	mail/shell.c, mail/size.c, mail/source.c, mail/summary.c,
	mail/table.c, mail/tag.c, mail/top.c, mail/touch.c,
	mail/unalias.c, mail/undelete.c, mail/unset.c,
	mail/util.c, mail/var.c, mail/version.c, mail/visual.c,
	mail/write.c, mail/z.c, mail/testsuite/Makefile.am,
	mail/testsuite/lib/mail.exp, mail/testsuite/mail/alias.exp,
	mail/testsuite/mail/folder.exp,
	mail/testsuite/mail/read.exp, mail/testsuite/mail/send.exp,
	mail/testsuite/mail/tag.exp, mail/testsuite/mail/write.exp,
	mail/testsuite/mail/z.exp, mail.local/Makefile.am,
	mail.local/mail.local.h, mail.local/mailquota.c,
	mail.local/main.c, mail.local/script.c,
	mail.local/testsuite/Data,
	mail.local/testsuite/Makefile.am,
	mail.local/testsuite/lib/mail.local.exp,
	mail.local/testsuite/mail.local/deliver.exp,
	mail.remote/Makefile.am, mail.remote/mail.remote.c,
	mail.remote/testsuite/Data,
	mail.remote/testsuite/Makefile.am,
	mail.remote/testsuite/lib/mail.remote.exp,
	mail.remote/testsuite/mail.remote/send.exp,
	mailbox/Makefile.am, mailbox/address.c, mailbox/alloca_.h,
	mailbox/amd.c, mailbox/argcv.c, mailbox/argp-ba.c,
	mailbox/argp-eexst.c, mailbox/argp-fmtstream.c,
	mailbox/argp-fmtstream.h, mailbox/argp-fs-xinl.c,
	mailbox/argp-help.c, mailbox/argp-namefrob.h,
	mailbox/argp-parse.c, mailbox/argp-pv.c,
	mailbox/argp-pvh.c, mailbox/argp-xinl.c, mailbox/argp.h,
	mailbox/asnprintf.c, mailbox/attachment.c,
	mailbox/attribute.c, mailbox/auth.c, mailbox/body.c,
	mailbox/daemon.c, mailbox/date.c, mailbox/debug.c,
	mailbox/envelope.c, mailbox/errors, mailbox/fgetpwent.c,
	mailbox/file_stream.c, mailbox/filter.c,
	mailbox/filter_iconv.c, mailbox/filter_rfc822.c,
	mailbox/filter_trans.c, mailbox/folder.c,
	mailbox/getline.c, mailbox/getline.h, mailbox/getndelim2.c,
	mailbox/getndelim2.h, mailbox/getopt.c,
	mailbox/getopt1.c, mailbox/getopt_.h, mailbox/getopt_int.h,
	mailbox/gettext.h, mailbox/header.c, mailbox/iterator.c,
	mailbox/list.c, mailbox/locale.c, mailbox/locker.c,
	mailbox/mailbox.c, mailbox/mailcap.c, mailbox/mailer.c,
	mailbox/mapfile_stream.c, mailbox/mbx_default.c,
	mailbox/md5.c, mailbox/md5.h, mailbox/memory_stream.c,
	mailbox/mempcpy.c, mailbox/mempcpy.h, mailbox/message.c,
	mailbox/mime.c, mailbox/minmax.h, mailbox/monitor.c,
	mailbox/mu_argp.c, mailbox/mu_auth.c, mailbox/muerrno.cin,
	mailbox/muerror.c, mailbox/munre.c, mailbox/mutil.c,
	mailbox/nls.c, mailbox/observer.c, mailbox/parse822.c,
	mailbox/parsedate.y, mailbox/printf-args.c,
	mailbox/printf-args.h, mailbox/printf-parse.c,
	mailbox/printf-parse.h, mailbox/property.c,
	mailbox/regex.c, mailbox/regex.h, mailbox/registrar.c,
	mailbox/rfc2047.c, mailbox/sendmail.c, mailbox/smtp.c,
	mailbox/strcase.h, mailbox/strcasecmp.c,
	mailbox/strchrnul.c, mailbox/strchrnul.h,
	mailbox/stream.c, mailbox/strndup.c, mailbox/strndup.h,
	mailbox/strnlen.c, mailbox/strtok_r.c, mailbox/strtok_r.h,
	mailbox/sysexit_.h, mailbox/system.c, mailbox/tcp.c,
	mailbox/ticket.c, mailbox/unlocked-io.h, mailbox/url.c,
	mailbox/url_sendmail.c, mailbox/url_smtp.c,
	mailbox/vasnprintf.c, mailbox/vasnprintf.h,
	mailbox/vsnprintf.c, mailbox/vsnprintf.h, mailbox/wicket.c,
	mailbox/xsize.h, mailbox/imap/Makefile.am,
	mailbox/imap/folder.c, mailbox/imap/mbox.c,
	mailbox/imap/url.c, mailbox/include/Makefile.am,
	mailbox/include/address0.h, mailbox/include/amd.h,
	mailbox/include/attribute0.h, mailbox/include/auth0.h,
	mailbox/include/body0.h, mailbox/include/debug0.h,
	mailbox/include/envelope0.h, mailbox/include/filter0.h,
	mailbox/include/folder0.h, mailbox/include/header0.h,
	mailbox/include/imap0.h, mailbox/include/iterator0.h,
	mailbox/include/list0.h, mailbox/include/mailbox0.h,
	mailbox/include/mailer0.h, mailbox/include/message0.h,
	mailbox/include/mime0.h, mailbox/include/monitor0.h,
	mailbox/include/observer0.h, mailbox/include/property0.h,
	mailbox/include/registrar0.h, mailbox/include/stream0.h,
	mailbox/include/url0.h, mailbox/maildir/Makefile.am,
	mailbox/maildir/folder.c, mailbox/maildir/maildir.h,
	mailbox/maildir/mbox.c, mailbox/mbox/Makefile.am,
	mailbox/mbox/folder.c, mailbox/mbox/mbox.c,
	mailbox/mbox/mbox0.h, mailbox/mbox/mboxscan.c,
	mailbox/mbox/url.c, mailbox/mh/Makefile.am,
	mailbox/mh/folder.c, mailbox/mh/mbox.c,
	mailbox/nntp/Makefile.am, mailbox/nntp/folder.c,
	mailbox/nntp/mbox.c, mailbox/nntp/nntp0.h,
	mailbox/nntp/nntp_article.c, mailbox/nntp/nntp_body.c,
	mailbox/nntp/nntp_carrier.c, mailbox/nntp/nntp_connect.c,
	mailbox/nntp/nntp_create.c, mailbox/nntp/nntp_date.c,
	mailbox/nntp/nntp_debug.c, mailbox/nntp/nntp_destroy.c,
	mailbox/nntp/nntp_disconnect.c, mailbox/nntp/nntp_group.c,
	mailbox/nntp/nntp_head.c, mailbox/nntp/nntp_help.c,
	mailbox/nntp/nntp_ihave.c, mailbox/nntp/nntp_last.c,
	mailbox/nntp/nntp_list_active.c,
	mailbox/nntp/nntp_list_distribpats.c,
	mailbox/nntp/nntp_list_distributions.c,
	mailbox/nntp/nntp_list_extensions.c,
	mailbox/nntp/nntp_list_newsgroups.c,
	mailbox/nntp/nntp_list_times.c,
	mailbox/nntp/nntp_mode_reader.c,
	mailbox/nntp/nntp_newgroups.c, mailbox/nntp/nntp_newnews.c,
	mailbox/nntp/nntp_next.c, mailbox/nntp/nntp_post.c,
	mailbox/nntp/nntp_quit.c, mailbox/nntp/nntp_readline.c,
	mailbox/nntp/nntp_response.c, mailbox/nntp/nntp_sendline.c,
	mailbox/nntp/nntp_stat.c, mailbox/nntp/nntp_stream.c,
	mailbox/nntp/nntp_timeout.c, mailbox/nntp/url.c,
	mailbox/pop/Makefile.am, mailbox/pop/folder.c,
	mailbox/pop/mbox.c, mailbox/pop/pop3_apop.c,
	mailbox/pop/pop3_capa.c, mailbox/pop/pop3_carrier.c,
	mailbox/pop/pop3_connect.c, mailbox/pop/pop3_create.c,
	mailbox/pop/pop3_debug.c, mailbox/pop/pop3_dele.c,
	mailbox/pop/pop3_destroy.c, mailbox/pop/pop3_disconnect.c,
	mailbox/pop/pop3_list.c, mailbox/pop/pop3_lista.c,
	mailbox/pop/pop3_noop.c, mailbox/pop/pop3_pass.c,
	mailbox/pop/pop3_quit.c, mailbox/pop/pop3_readline.c,
	mailbox/pop/pop3_response.c, mailbox/pop/pop3_retr.c,
	mailbox/pop/pop3_rset.c, mailbox/pop/pop3_sendline.c,
	mailbox/pop/pop3_stat.c, mailbox/pop/pop3_stls.c,
	mailbox/pop/pop3_stream.c, mailbox/pop/pop3_timeout.c,
	mailbox/pop/pop3_top.c, mailbox/pop/pop3_uidl.c,
	mailbox/pop/pop3_uidla.c, mailbox/pop/pop3_user.c,
	mailbox/pop/url.c, mailbox/testsuite/Addrs,
	mailbox/testsuite/Mailcap, mailbox/testsuite/Makefile.am,
	mailbox/testsuite/Mime, mailbox/testsuite/RFC2047,
	mailbox/testsuite/Urls, mailbox/testsuite/lib/mailbox.exp,
	mailbox/testsuite/mailbox/address.exp,
	mailbox/testsuite/mailbox/base64.exp,
	mailbox/testsuite/mailbox/list.exp,
	mailbox/testsuite/mailbox/mailcap.exp,
	mailbox/testsuite/mailbox/mime.exp,
	mailbox/testsuite/mailbox/rfc2047.exp,
	mailbox/testsuite/mailbox/url.exp, messages/Makefile.am,
	messages/messages.c, messages/testsuite/Makefile.am,
	messages/testsuite/messages/test.exp, mh/Makefile.am,
	mh/ali.c, mh/anno.c, mh/comp.c, mh/compcommon.c,
	mh/fmtcheck.c, mh/folder.c, mh/forw.c, mh/inc.c,
	mh/install-mh.c, mh/mailutils-mh.eli, mh/mark.c, mh/mh.h,
	mh/mh_alias.l, mh/mh_alias.y, mh/mh_argp.c, mh/mh_ctx.c,
	mh/mh_error.c, mh/mh_fmtgram.y, mh/mh_format.c,
	mh/mh_getopt.c, mh/mh_getopt.h, mh/mh_global.c,
	mh/mh_init.c, mh/mh_list.c, mh/mh_msgset.c,
	mh/mh_sequence.c, mh/mh_stream.c, mh/mh_whatnow.c,
	mh/mh_whom.c, mh/mhl.c, mh/mhn.c, mh/mhparam.c,
	mh/mhpath.c, mh/pick.c, mh/pick.h, mh/pick.y, mh/refile.c,
	mh/repl.c, mh/rmf.c, mh/rmm.c, mh/scan.c, mh/send.c,
	mh/sortm.c, mh/whatnow.c, mh/whom.c, mimeview/Makefile.am,
	mimeview/mimetypes.l, mimeview/mimetypes.y,
	mimeview/mimeview.c, mimeview/mimeview.h,
	movemail/Makefile.am, movemail/movemail.c,
	po/.cvsignore, po/ca.po, po/es.po, po/fr.po, po/pl.po,
	po/ro.po, po/ru.po, po/uk.po, pop3d/Makefile.am,
	pop3d/apop.c, pop3d/auth.c, pop3d/capa.c, pop3d/dele.c,
	pop3d/expire.c, pop3d/extra.c, pop3d/list.c, pop3d/lock.c,
	pop3d/logindelay.c, pop3d/noop.c, pop3d/pop3d.c,
	pop3d/pop3d.h, pop3d/popauth.c, pop3d/quit.c,
	pop3d/retr.c, pop3d/rset.c, pop3d/signal.c, pop3d/stat.c,
	pop3d/stls.c, pop3d/top.c, pop3d/uidl.c, pop3d/user.c,
	pop3d/testsuite/Makefile.am, pop3d/testsuite/lib/pop3d.exp,
	pop3d/testsuite/pop3d/read.exp, readmsg/Makefile.am,
	readmsg/msglist.c, readmsg/readmsg.c,
	readmsg/readmsg.h, readmsg/testsuite/Makefile.am,
	readmsg/testsuite/readmsg/test.exp,
	scripts/Makefile.am, scripts/config.rpath,
	scripts/generr.awk, scripts/texify.sed,
	scripts/ylwrap, scripts/guile-1.4/Makefile.am,
	scripts/guile-1.4/guile-doc-snarf,
	scripts/guile-1.4/guile-func-name-check,
	scripts/guile-1.4/guile-snarf.awk,
	scripts/guile-1.6/Makefile.am,
	scripts/guile-1.6/guile-doc-snarf,
	scripts/guile-1.6/guile-doc-snarf.awk, sieve/Makefile.am,
	sieve/sieve.c, sieve/testsuite/Makefile.am,
	sieve/testsuite/Redirect, sieve/testsuite/Reject,
	sieve/testsuite/lib/sieve.exp,
	sieve/testsuite/sieve/action.exp,
	sieve/testsuite/sieve/address.exp,
	sieve/testsuite/sieve/allof.exp,
	sieve/testsuite/sieve/anyof.exp,
	sieve/testsuite/sieve/envelope.exp,
	sieve/testsuite/sieve/exists.exp,
	sieve/testsuite/sieve/ext.exp,
	sieve/testsuite/sieve/false.exp,
	sieve/testsuite/sieve/header.exp,
	sieve/testsuite/sieve/i-casemap.exp,
	sieve/testsuite/sieve/i-numeric.exp,
	sieve/testsuite/sieve/i-octet.exp,
	sieve/testsuite/sieve/mul-addr.exp,
	sieve/testsuite/sieve/not.exp,
	sieve/testsuite/sieve/redirect.exp,
	sieve/testsuite/sieve/reject.exp,
	sieve/testsuite/sieve/relational.exp,
	sieve/testsuite/sieve/size.exp,
	sieve/testsuite/sieve/true.exp, sql/Makefile.am,
	sql/mysql.c, sql/odbc.c, sql/postgres.c, sql/sql.c,
	testsuite/Makefile.am, testsuite/makespool,
	testsuite/lib/mailutils.exp

2005-05-13  Sergey Poznyakoff  <gray@Mirddin.farlep.net>

	* imap4d/fetch.c (imap4d_fetch0): Reduce memory consumption within
	the mailbox scanning loop. Break the loop when an invalid msgno is
	encountered or the message cannot be retrieved.
	(fetch_io): Check for integer overflow (IDEF0956).
	(fetch_full,fetch_rfc822_header,fetch_rfc822_text)
	(fetch_operation): Propagate return value back to the caller.
	
	* imap4d/util.c (util_finish): Fix potential vulnerability
	(IDEF0954).
	(util_msgset): Do not allow values greater than the maximum id
	number (either message number or UID) in the mailbox. Fixes (IDEF0955).
	
	* mailbox/header.c (header_get_field_name): Fix buffer overflow
	(IDEF0957).

	* doc/texinfo/sieve.texi: Fix typo

	* imap4d/testsuite/imap4d/IDEF0955.exp: New test
	* imap4d/testsuite/imap4d/IDEF0956.exp: New test
	* imap4d/testsuite/imap4d/DISTFILES: Add new files
	
2005-05-11  Sergey Poznyakoff 

	* mailbox/parsedate.y (DATE_INIT): Bugfix. Several fields in
	struct pd_date are used regardless of .mask, so it is better to
	zero out the entire structure.

2005-03-25  Sergey Poznyakoff 

	* NEWS: Updated
	* mail/decode.c (display_message0): Do not interpret MIME
	parts if metamail is unset.
	* mail/mail.c (default_setup): Set metamail
	* testsuite/etc/mail.rc: Unset metamail
	* doc/texinfo/programs.texi: Updated metamail documentation

2005-03-18  Sergey Poznyakoff

	* TODO: Updated
	* README-alpha: Updated
	* mail/shell.c (mail_execute): Restore argv[0] before exiting,
	else argcv_free coredumps.

2005-03-15  Sergey Poznyakoff  

	* mailbox/mailbox.c (mailbox_flush): Do not re-save all messages
	if the mailbox was opened in append mode.

2005-03-14  Sergey Poznyakoff 

	* mimeview/mimetypes.l (<HEX>): Bugfix
	* mimeview/mimetypes.y (b_string): Bugfix
	
2005-03-13  Sergey Poznyakoff 

	Sources are tagged alpha_0_6_1
	
	* Makefile.am (SUBDIRS): Reordered. Due to the specifics
	of gnulib imports, libmailutils depends on libmailbox.
	Added config/.
	* configure.ac (AC_CONFIG_FILES): Added config/Makefile
	* lib/mailcap.c (mime_context_fill): Return integer code
	(display_stream_mailcap): Bail out if mime_context_fill
	returns 1

	* mailbox/Makefile.am: Removed mailutils-config.c. It should
	live in a separate directory to satisfy interlibrary dependencies.
	* mailbox/mailutils-config.c: Moved to config
	* config: New directory
	* config/mailutils-config.c: New file
	* config/Makefile.am: New file
	
	* po/POTFILES.in: Updated

2005-03-13  Sergey Poznyakoff 

	* lib/mailcap.c Include ctype.h
	(mime_context_fill): Remove leading whitespace
	when preparing lists.
	(mime_context_get_content_type_value): Return integer code.
	(expand_string): Fixed expansion of %{name}
	* mh/send.c: Use gettext markers in verbose diagnostics.

2005-03-12  Sergey Poznyakoff 

	* README: Updated. Switch to outline mode.
	* README-alpha: Updated. Switch to outline mode.
	* mailbox/mutil.c: Minor indentation fix
	* mailbox/pop/pop3_sendline.c: Do not redefine _GNU_SOURCE
	* mailbox/nntp/nntp_sendline.c: Likewise

2005-03-12  Sergey Poznyakoff 

	* lib/mailcap.c: New file. Routines for displaying MIME
	messages.
	* lib/Makefile.am: Added mailcap.c
	* mimeview/mimeview.c: Rewritten using display_stream_mailcap.
	* mail/decode.c: Implemented built-in mailcap mechanism
	* mail/Makefile.am: (mail_LDADD): Changed order of loading
	libmailutils/libmailbox
	* mimeview/Makefile.am (mimeview_LDADD): Likewise
	* doc/texinfo/programs.texi (mail): Documented variable
	mimenoask
	* po/POTFILES.in: Updated
	* examples/mta.c (header): Removed unused global
	* NEWS: Updated
	
2005-03-10  Sergey Poznyakoff

	* TODO: Updated
	* imap4d/imap4d.h (define _GNU_SOURCE): Removed. Defined
	in config.h
	* mailbox/mailcap.c (mu_mailcap_entry_get_value): Bugfix: return
	ENOENT if no matching entry is found.
	* mailbox/mutil.c (mu_true_answer_p): Ignore leading whitespace.
	* mh/mh_init.c (mh_vgetyn): Synchronize with the changes to
	mu_true_answer_p().
	* mimeview/mimeview.c: Handle --no-ask and --no-interactive (-h)
	options. Continue search for a matching entry when necessary.
	Implement 'test' and 'print' commands.
	* doc/texinfo/programs.texi (mimeview): Documented new options
	
2005-03-09  Sergey Poznyakoff

	* mimeview/mimetypes.l: Bugfix: accept ',' as OR
	* mimeview/mimetypes.y: Fixed precedences of ',' and '+'.

2005-03-08  Sergey Poznyakoff

	* TODO: Updated
	* configure.ac (DEFAULT_CUPS_CONFDIR): New variable
	* doc/texinfo/programs.texi (mimeview): Documented the program
	* mimeview/Makefile.am (AM_CFLAGS): Use DEFAULT_CUPS_CONFDIR
	* mimeview/mimeview.c (create_filter,print_exit_status)
	(get_pager): New function
	(run_mailcap): Pipe file contents to the command if its invocation
	does not contain %s.
	Use pager if `copiousoutput' is specified in mailcap

	* po/POTFILES.in: Updated
	
2005-03-08  Sergey Poznyakoff 

	TODO:121 said: "file viewer, based on the mimetypes api. I want to do
	a "v foo.blah", have it look up .blah in mime.types, and do the 
	action spec'ed in mailcap."
	So, here it goes:

	* mimeview: New directory
	* mimeview/mimetypes.y: New file
	* mimeview/mimetypes.l: New file
	* mimeview/mimeview.c: New file
	* mimeview/mimeview.h: New file
	* mimeview/Makefile.am: New file
	* mimeview/.cvsignore: New file	 

	* configure.ac: Added mimeview
	* Makefile.am: Likewise
	* doc/texinfo/programs.texi (mimeview): New section.
	(mail): Document recently added variables.
	* mailbox/mailcap.c (mu_mailcap_entry_copiousoutput): Bugfix
	
2005-03-07  Sergey Poznyakoff

	* TODO: Updated
	* NEWS: Updated
	* mail/decode.c (mail_decode): Implemented new variable
	`metamail' that turns on use of metamail program for
	displaying MIME messages.
	(run_metamail): New function
	* mailbox/mutil.c (mu_spawnvp): Minor fixes

2005-03-06  Sergey Poznyakoff 

	* NEWS: Updated
	
	* auth/sql.c: Use a uniform way of filename quoting in diagnostic
	messages.
	* frm/common.c: Likewise
	* frm/from.c: Likewise
	* imap4d/authenticate.c: Likewise
	* imap4d/login.c: Likewise
	* libsieve/actions.c: Likewise
	* libsieve/extensions/vacation.c: Likewise
	* mail/var.c: Likewise
	* mail.local/mailquota.c: Likewise
	* mail.local/main.c: Likewise
	* mail.remote/mail.remote.c: Likewise
	* mailbox/mu_argp.c: Likewise
	* messages/messages.c: Likewise
	* mh/forw.c: Likewise
	* mh/mh_ctx.c: Likewise
	* mh/mh_init.c: Likewise
	* mh/send.c: Likewise
	* movemail/movemail.c: Likewise
	* pop3d/apop.c: Likewise
	* pop3d/lock.c: Likewise
	* pop3d/user.c: Likewise
	* readmsg/readmsg.c: Likewise
	* sieve/sieve.c: Likewise
	
	* mailbox/errors (MU_ERR_NO_QUERY): Fixed wording

2005-03-05  Wojciech Polak

	* frm/Makefile.am: Removed install-exec-hook after the changes
	from 2005-03-02.

2005-03-05  Sergey Poznyakoff 

	POSIX compatibility issues in mail
	
	* mail/alt.c (mail_is_my_name): Do not check `metoo'. The
	caller is responsible for that.
	* mail/reply.c (reply0): Check for `metoo' before calling
	mail_is_my_name().
	(mail_reply): Honor `flipr' variable
	* mail/decode.c: Mark message as read and shown
	* mail/mbox.c: Likewise
	* mail/pipe.c: Likewise
	* mail/print.c: Likewise
	* mail/top.c: Likewise
	* mail/undelete.c: Likewise
	* mail/visual.c: Likewise
	* mail/from.c (mail_from0): If `showto' is set and the
	mail comes from the user that invoked the program, show
	`To:' address instead of `From:'.
	* mail/mail.c (default_setup): Added variables, required by
	POSIX: flipr, showto, bang. Added placeholders for debug,
	onehop and sendwait.
	* mail/mail.h (util_mark_read): New function
	* mail/shell.c: If `bang' is set, expand every occurrence
	of ! in argument array.
	* mail/touch.c: Rewritten in accordance with POSIX specs:
	do not mbox deleted and saved messages.
	* mail/util.c (util_mark_read): New function
	
2005-03-04  Sergey Poznyakoff  

	* mail/mail.h (MAIL_ATTRIBUTE_SHOWN): New attribute. Shows
	that the message has been displayed during the current session.
	* mail/next.c (mail_next): Rewritten in accordance with posix:
	if the current message has not been shown yet, then show
	it. Otherwise advance to the nearest next non-deleted message.
	* mail/print.c (mail_print_msg): Set MAIL_ATTRIBUTE_SHOWN after
	displaying the message
	* mail/top.c (top0): set read attribute and MAIL_ATTRIBUTE_SHOWN
	after displaying the message

2005-03-02  Sergey Poznyakoff

	* frm/Makefile.am: Build `from'
	* frm/frm.c: Moved part of code to be shared between `frm' and
	`from' to common.c
	* frm/common.c: New file
	* frm/from.c: New file
	* frm/frm.h: New file
	* mail/quit.c: Save messages that were marked for saving to mbox
	and then deleted
	* mailbox/mbox/mbox.c (mbox_scan): Store the number of messages
	into *pcount if we don't need to rescan the mailbox.

	* po/POTFILES.in: Updated

	* from/from.c: Removed
	* from/Makefile.am: Removed
	* from/.cvsignore: Removed
	* from/testsuite: Removed
	* from/testsuite/from/test.exp: Removed
	* from/testsuite/from/DISTFILES: Removed

	* configure.ac: Removed from
	* Makefile.am: Likewise
	* doc/texinfo/programs.texi: Document `from'
	
2005-02-28  Sergey Poznyakoff

	* configure.ac: Check for FriBidi
	* frm/Makefile.am: Link with libfribidi
	* frm/frm.c: Rewritten output routines using FriBidi. Arabic
	subject lines look almost OK, except that all characters are
	displayed in isolated variant. 
	* frm/testsuite/frm/test.exp: Fixed to match the new frm output.

2005-02-27  Wojciech Polak

	* frm/Makefile.am: Added install-exec-hook for creating
	the symbolic link 'from' to 'frm'.
	* from/Makefile.am: Changed bin_PROGRAMS to noinst_PROGRAMS.

2005-02-27  Sergey Poznyakoff 

	* gnulib.modules: Add mbswidth
	* frm/frm.c: Implemented -t. Changed implementation of -Q.
	Rewritten action() to correctly handle multibyte characters
	and to provide for eventual using the BIDI algorithm.
	(print_line,format_field,format_field_simple)
	(format_field_align): New functions
	(util_getcols): Measure /dev/tty if unable to open stdout.
	(to work correctly with piped output).
	(rfc2047_decode_wrapper): Cache the determined locale.
	(get_personal): Do not limit the returned string length.
	Do not attempt to decode the raw header text, since
	parse822 will skip non-ascii characters, decode the already
	obtained personal part instead.

	* mailbox/address.c (address_aget_personal)
	(address_aget_comments): Bugfix
	* sql/mysql.c: Provide place handlers for handling MySQL 4.1.x
	scrambled passwords.
	
	Update by gnulib-sync:
	
	* m4/mbrtowc.m4: New file
	* m4/mbswidth.m4: New file
	* lib/mbswidth.c: New file
	* lib/mbswidth.h: New file
	* lib/Makefile.am: Updated
	* m4/gnulib.m4: Updated

2005-02-26  Wojciech Polak

	* mh/send.c (expand_aliases): Bugfix. Do not use statically
	allocated buffer. Use header_aget_field_name() instead.
	The utility froze with header names longer than 16 bytes.

2005-02-26  Wojciech Polak

	* mailbox/url_smtp.c (_url_smtp_init): Do not reject
	an URL with user name, password, or auth method specified.
	We will use it in further ESMTP authentication.

2005-02-26  Sergey Poznyakoff

	* sql/mysql.c: Do not use any libmysql functions to
	scramble passwords: mysql people are evidently
	unable to keep this API stable.

2005-02-25  Sergey Poznyakoff 

	* NEWS: Updated
	* auth/sql.c (mu_sql_password_type): New variable
	(--sql-password-type): New command line option
	(mu_sql_getpass): New function.
	(mu_sql_authenticate): Recognize hashed, plaintext
	and mysql scrambled passwords.
	* auth/sql.h (sql_interface): new decl
	(mu_sql_expand_query): New proto.
	* imap4d/auth_gsasl.c (cb_retrieve): Fall back to SQL
	if plaintext password file is not available.
	* include/mailutils/sql.h (mu_sql_getpass)
	(mu_sql_password_type,mu_sql_expand_query):
	(mu_check_mysql_scrambled_password): New function
	* mail.local/mailquota.c: Include <auth/sql.h>. A temporary
	solution.

	* mailbox/muerror.c (mu_syslog_error_printer): Bugfix.
	* sql/mysql.c (mu_check_mysql_scrambled_password): New function.

	* mail/mail.c: Updated copyright date.
	
2005-02-25  Sergey Poznyakoff 

	* NEWS: Updated
	* include/mailutils/libsieve.h (sieve_get_identifier): New
	function.
	(sieve_arg_error): New function.
	* libsieve/actions.c: Removed spurions indications of action
	names in diagnostic messages. Sieve_error prepends them
	automatically now.
	* libsieve/tests.c: Likewise.
	* libsieve/extensions/list.c: Likewise.
	* libsieve/extensions/timestamp.c: Likewise.
	* libsieve/extensions/vacation.c: Likewise.
	* libsieve/runtime.c (instr_action,instr_test): Update
	mach->identifier.
	* libsieve/sieve.h (struct sieve_machine.identifier): New
	field.
	
	* libsieve/util.c (sieve_value_create): Bugfix.
	(sieve_error): Prepend action or test identifier to the diagnostic
	message.
	(sieve_arg_error): New function.
	
	* po/POTFILES.in: Updated
	
2005-02-24  Sergey Poznyakoff

	Update by gnulib-sync.
	
	* lib/stdbool.h: New file
	* m4/unlocked-io.m4: New file
	* m4/argp.m4: Updated
	* m4/gnulib.m4: Updated
	* mailbox/Makefile.am: Updated

2005-02-23  Sergey Poznyakoff  

	Synchronized with the recent gnulib. Provide a way to
	facilitate further synchronizations.
	
	* gnulib.modules: New file
	* scripts/gnulib-sync: New file. Script for synchronizing
	mailutils tree with gnulib.
	* configure.ac: Updated to use new gnulib files.
	* m4/mu_libobj.m4 (MU_LIBSOURCES,MU_REPLACE_FUNCS): New defun.
	(MU_CHECK_FUNCS): Removed.

	* Makefile.am: Remove headers/
	* frm/frm.c (parse_opt): Bugfix. Was using optarg instead of arg
	* mail.local/main.c: Likewise
	* pop3d/popauth.c: Likewise
	* readmsg/readmsg.c: Likewise
	* include/mailutils/argp.h: Include errno.h
	* include/mailutils/gnu/Makefile.am: Remove posix/regex.h
	* libsieve/argp.c (sieve_argp_option): Use N_()
	* mailbox/message.c: Use new md5 calls
	* mailbox/pop/mbox.c: Likewise
	* mailbox/pop/pop3_apop.c: Likewise
	* mailbox/message.c: Likewise
	* mh/mh_error.c: Include mailutils/argp.h
	* mh/mh_getopt.c: Include string.h
	* pop3d/Makefile.am (INCLUDES): Add $(top_srcdir)/mailbox
	* pop3d/pop3d.h: Minor fix

	* lib/xalloc_die.c: New file
	* m4/gnulib.m4: New file

	* headers/.cvsignore
	* headers/Makefile.am
	* headers/getopt.h
	* headers/regex.h
	* headers/argp.h
	* headers/posix/.cvsignore
	* headers/posix/Makefile.am
	* headers/posix/regex.h
	* headers/posix

	Update by gnulib-sync. 

	* lib/asprintf.c: New file 
	* mailbox/alloca.h: New file
	* mailbox/argp.h: New file
	* mailbox/getopt.h: New file
	* lib/allocsa.c: Added to the repository
	* lib/allocsa.h: Added to the repository
	* lib/allocsa.valgrind: Added to the repository
	* lib/asprintf.c: Updated
	* lib/error.c: Added to the repository
	* lib/error.h: Updated
	* lib/exit.h: Added to the repository
	* lib/exitfail.c: Added to the repository
	* lib/exitfail.h: Added to the repository
	* lib/fnmatch.c: Updated
	* lib/fnmatch_.h: Added to the repository
	* lib/fnmatch_loop.c: Added to the repository
	* lib/getpass.c: Updated
	* lib/getpass.h: Added to the repository
	* lib/malloc.c: Updated
	* lib/obstack.c: Updated
	* lib/obstack.h: Updated
	* lib/realloc.c: Updated
	* lib/setenv.c: Updated
	* lib/setenv.h: Added to the repository
	* lib/snprintf.c: Updated
	* lib/snprintf.h: Updated
	* lib/stdbool_.h: Added to the repository
	* lib/unsetenv.c: Added to the repository
	* lib/vasprintf.c: Updated
	* lib/vasprintf.h: Added to the repository
	* lib/xalloc.h: Updated
	* lib/xmalloc.c: Updated
	* lib/xsize.h: Added to the repository
	* lib/xstrtol.c: Updated
	* lib/xstrtol.h: Updated
	* lib/xstrtoul.c: Added to the repository
	* m4/alloca.m4: Added to the repository
	* m4/allocsa.m4: Added to the repository
	* m4/argp.m4: Added to the repository
	* m4/eealloc.m4: Added to the repository
	* m4/eoverflow.m4: Added to the repository
	* m4/error.m4: Added to the repository
	* m4/exitfail.m4: Added to the repository
	* m4/extensions.m4: Added to the repository
	* m4/fnmatch.m4: Added to the repository
	* m4/getline.m4: Added to the repository
	* m4/getndelim2.m4: Added to the repository
	* m4/getopt.m4: Updated
	* m4/getpass.m4: Added to the repository
	* m4/gettext_gl.m4: Added to the repository
	* m4/glibc21_gl.m4: Added to the repository
	* m4/iconv.m4: Added to the repository
	* m4/intmax.m4: Added to the repository
	* m4/intmax_t.m4: Added to the repository
	* m4/intmax_t.m4: Added to the repository
	* m4/inttypes.m4: Added to the repository
	* m4/inttypes_h_gl.m4: Added to the repository
	* m4/inttypes_h_gl.m4: Added to the repository
	* m4/lib-ld_gl.m4: Added to the repository
	* m4/lib-prefix_gl.m4: Added to the repository
	* m4/longdouble.m4: Added to the repository
	* m4/longdouble.m4: Added to the repository
	* m4/longlong_gl.m4: Added to the repository
	* m4/longlong_gl.m4: Added to the repository
	* m4/mailbox-link.m4: Added to the repository
	* m4/mbstate_t.m4: Added to the repository
	* m4/md5.m4: Added to the repository
	* m4/mempcpy.m4: Added to the repository
	* m4/nls.m4: Added to the repository
	* m4/obstack.m4: Added to the repository
	* m4/onceonly.m4: Added to the repository
	* m4/onceonly.m4: Added to the repository
	* m4/po_gl.m4: Added to the repository
	* m4/printf-posix.m4: Added to the repository
	* m4/progtest.m4: Added to the repository
	* m4/regex.m4: Updated
	* m4/restrict.m4: Added to the repository
	* m4/setenv.m4: Added to the repository
	* m4/signed.m4: Added to the repository
	* m4/size_max.m4: Added to the repository
	* m4/size_max.m4: Added to the repository
	* m4/snprintf.m4: Added to the repository
	* m4/ssize_t.m4: Added to the repository
	* m4/stdbool.m4: Added to the repository
	* m4/stdint_h_gl.m4: Added to the repository
	* m4/stdint_h_gl.m4: Added to the repository
	* m4/strcase.m4: Added to the repository
	* m4/strchrnul.m4: Added to the repository
	* m4/strerror_r.m4: Added to the repository
	* m4/strndup.m4: Added to the repository
	* m4/strnlen.m4: Added to the repository
	* m4/strtok_r.m4: Added to the repository
	* m4/sysexits.m4: Added to the repository
	* m4/uint32_t.m4: Added to the repository
	* m4/uintmax_t_gl.m4: Added to the repository
	* m4/uintmax_t_gl.m4: Added to the repository
	* m4/ulonglong_gl.m4: Added to the repository
	* m4/ulonglong_gl.m4: Added to the repository
	* m4/vasnprintf.m4: Added to the repository
	* m4/vasprintf.m4: Added to the repository
	* m4/vsnprintf.m4: Added to the repository
	* m4/wchar_t.m4: Added to the repository
	* m4/wint_t.m4: Added to the repository
	* m4/xalloc.m4: Added to the repository
	* m4/xsize.m4: Added to the repository
	* m4/xsize.m4: Added to the repository
	* m4/xstrtol.m4: Added to the repository
	* mailbox/alloca.c: Added to the repository
	* mailbox/alloca_.h: Added to the repository
	* mailbox/argp-ba.c: Updated
	* mailbox/argp-eexst.c: Updated
	* mailbox/argp-fmtstream.c: Updated
	* mailbox/argp-fmtstream.h: Updated
	* mailbox/argp-fs-xinl.c: Updated
	* mailbox/argp-help.c: Updated
	* mailbox/argp-namefrob.h: Updated
	* mailbox/argp-parse.c: Updated
	* mailbox/argp-pv.c: Updated
	* mailbox/argp-pvh.c: Updated
	* mailbox/argp-xinl.c: Updated
	* mailbox/argp.h: Updated
	* mailbox/asnprintf.c: Added to the repository
	* mailbox/getline.c: Updated
	* mailbox/getline.h: Updated
	* mailbox/getndelim2.c: Added to the repository
	* mailbox/getndelim2.h: Added to the repository
	* mailbox/getopt.c: Updated
	* mailbox/getopt1.c: Updated
	* mailbox/getopt_.h: Added to the repository
	* mailbox/getopt_int.h: Added to the repository
	* mailbox/gettext.h: Added to the repository
	* mailbox/md5.c: Updated
	* mailbox/md5.h: Updated
	* mailbox/mempcpy.c: Added to the repository
	* mailbox/mempcpy.h: Added to the repository
	* mailbox/minmax.h: Added to the repository
	* mailbox/printf-args.c: Added to the repository
	* mailbox/printf-args.h: Added to the repository
	* mailbox/printf-parse.c: Added to the repository
	* mailbox/printf-parse.h: Added to the repository
	* mailbox/regex.c: Updated
	* mailbox/regex.h: Added to the repository
	* mailbox/strcase.h: Added to the repository
	* mailbox/strcasecmp.c: Added to the repository
	* mailbox/strchrnul.c: Updated
	* mailbox/strchrnul.h: Added to the repository
	* mailbox/strncasecmp.c: Added to the repository
	* mailbox/strndup.c: Updated
	* mailbox/strndup.h: Added to the repository
	* mailbox/strnlen.c: Updated
	* mailbox/strtok_r.c: Updated
	* mailbox/strtok_r.h: Added to the repository
	* mailbox/sysexit_.h: Added to the repository
	* mailbox/vasnprintf.c: Added to the repository
	* mailbox/vasnprintf.h: Added to the repository
	* mailbox/vsnprintf.c: Added to the repository
	* mailbox/vsnprintf.h: Added to the repository
	* mailbox/xsize.h: Added to the repository
	* scripts/config.rpath: Added to the repository
	
2005-02-21  Sergey Poznyakoff

	* libsieve/actions.c: Further unification of diagnostic style.
	* libsieve/argp.c: Likewise.
	* mail/mail.c: Likewise.
	* mail.local/mailquota.c: Likewise.
	* mailbox/mu_argp.c: Likewise.
	* mh/forw.c: Likewise.
	* mh/refile.c: Likewise.
	* mh/repl.c: Likewise.
	* mh/send.c: Likewise.
	* sieve/sieve.c: Likewise.
	* mail.local/main.c: Add debug flag 'i' for symmetry with sieve

2005-02-16  Sergey Poznyakoff

	Fix a long-standing issue in mailbox and imap4d:
	be able to handle a case when a third-party program deletes
	some messages in the mailbox being open by imap4d (imap4d
	cannot and should not lock it, hence the possibility).
	
	* mailbox/amd.c (amd_pool_flush): New function.
	(amd_close): Call amd_pool_flush()
	and initialize amd data so that subsequent amd_open() works
	properly.
	(amd_destroy): Call amd_pool_flush.
	* mailbox/mbox/mbox.c (mbox_close): Initialize all private data
	so that subsequent mailbox_open() works properly.
	(mbox_is_updated): Updated comment

	* imap4d/bye.c (imap4d_bye0): Handle ERR_MAILBOX_CORRUPTED
	* imap4d/imap4d.h (ERR_MAILBOX_CORRUPTED): New error code.
	(imap4d_set_observer): New function
	* imap4d/select.c (imap4d_select0): Call imap4d_set_observer()
	* imap4d/sync.c (imap4d_set_observer): New function.
	(imap4d_sync): Check if the mailbox was shrunk (in libmailbox
	terms 'corrupted'). If so, reopen it and issue untagged alert.

2005-02-16  Sergey Poznyakoff

	* imap4d/auth_gsasl.c (cb_validate): Provide normal authentication
	for PLAIN and LOGIN mechanisms.

2005-02-11  Sergey Poznyakoff 

	* imap4d/unsubscribe.c: Rewritten. Thanks Andrew Barnes
	for reporting the bug.

2005-02-03  Sergey Poznyakoff

	* guimb/main.c (parse_opt): Use arg instead of optarg.
	Thanks James Dolter for reporting.

2005-01-17  Sergey Poznyakoff 

	* mailbox/parsedate.y (mu_parse_date): Initialize struct tm
	* mailbox/nntp/folder.c (nntp_folder_open): Do not use alloca
	* mailbox/nntp/mbox.c: Do not use alloca
	
	* doc/texinfo/Makefile.am: Rewritten to use gendocs.sh
	* doc/texinfo/index.html.in: Removed
	* doc/texinfo/gendocs_template: New file
	* doc/texinfo/fdl.texi: Fixed sectioning
	* doc/texinfo/programs.texi: Likewise.
	* doc/texinfo/url.texi: Likewise.
	* doc/texinfo/mailutils.texi: Fixed sectioning. Print table
	of contents after summary page, as suggested by GNU standards.

2005-01-05  Sergey Poznyakoff 

	* configure.ac (AUTHLIBS_DEPENDENCY,SQLLIB_DEPENDENCY): New
	variables. I still hope to find a better solution, though
	(see comment to imap4d_DEPENDENCIES in imap4d/Makefile.am).
	New SQL driver: ODBC (--with-sql=odbc or --with-odbc)
	Raised version number to 0.6.1
	* NEWS: Updated
	* README: Updated
	* auth/Makefile.am: Use explicit PROG_DEPENDENCIES
	* imap4d/Makefile.am: Likewise.
	* pop3d/Makefile.am: Likewise.
	
	* include/mailutils/sql.h (mu_sql_dispatch.errstr): Changed
	return type to const char*
	* sql/mysql.c: Likewise
	* sql/postgres.c: Likewise
	* sql/sql.c: Likewise
	
	* sql/odbc.c: New file. ODBC SQL driver.	
	* sql/Makefile.am: Add odbc.c
	
	* mail/testsuite/mail/read.exp: Updated to match recent changes
	in diagnostic messages.

2005-01-04  Sergey Poznyakoff 

	* libsieve/extensions/vacation.c: New action. Based on
	guimb/scm/vacation.scm and on ideas and code fragments from
	Felix Egli <fegli@goldnet.ch>.
	* libsieve/extensions/Makefile.am: Add vacation
	* include/mailutils/libsieve.h (sieve_get_message_sender)
	(stream_printf): New prototypes.
	* THANKS: Add Felix Egli

2005-01-04  Sergey Poznyakoff 

	* auth/sql.c: Revise error messages for accordance with GNU standards:
	begin messages with a capital letter, unless they are prefixed
	with `file:line:' or their exact look is important due to
	compatibility reasons. Do not end messages with a period.
	Avoid using contracted negations
	* auth/tls.c: Likewise
	* comsat/action.c: Likewise
	* comsat/cfg.c: Likewise
	* comsat/comsat.c: Likewise
	* dotlock/dotlock.c: Likewise
	* frm/frm.c: Likewise
	* from/from.c: Likewise
	* guimb/collect.c: Likewise
	* guimb/main.c: Likewise
	* guimb/util.c: Likewise
	* imap4d/auth_gss.c: Likewise
	* imap4d/imap4d.c: Likewise
	* imap4d/list.c: Likewise
	* imap4d/signal.c: Likewise
	* imap4d/util.c: Likewise
	* libsieve/actions.c: Likewise
	* libsieve/comparator.c: Likewise
	* libsieve/prog.c: Likewise
	* libsieve/runtime.c: Likewise
	* libsieve/sieve.l: Likewise
	* libsieve/tests.c: Likewise
	* libsieve/util.c: Likewise
	* mail/alt.c: Likewise
	* mail/copy.c: Likewise
	* mail/decode.c: Likewise
	* mail/file.c: Likewise
	* mail/if.c: Likewise
	* mail/mail.c: Likewise
	* mail/mailline.c: Likewise
	* mail/quit.c: Likewise
	* mail/send.c: Likewise
	* mail/source.c: Likewise
	* mail/unalias.c: Likewise
	* mail/util.c: Likewise
	* mail/var.c: Likewise
	* mail/z.c: Likewise
	* mail.local/mailquota.c: Likewise
	* mail.local/main.c: Likewise
	* mail.local/script.c: Likewise
	* mailbox/mailutils-config.c: Likewise
	* mailbox/mu_argp.c: Likewise
	* messages/messages.c: Likewise
	* mh/fmtcheck.c: Likewise
	* mh/folder.c: Likewise
	* mh/forw.c: Likewise
	* mh/inc.c: Likewise
	* mh/mark.c: Likewise
	* mh/mh_argp.c: Likewise
	* mh/mh_ctx.c: Likewise
	* mh/mh_fmtgram.y: Likewise
	* mh/mh_format.c: Likewise
	* mh/mh_init.c: Likewise
	* mh/mh_list.c: Likewise
	* mh/mh_msgset.c: Likewise
	* mh/mh_whom.c: Likewise
	* mh/mhl.c: Likewise
	* mh/mhn.c: Likewise
	* mh/pick.c: Likewise
	* mh/refile.c: Likewise
	* mh/repl.c: Likewise
	* mh/rmf.c: Likewise
	* mh/scan.c: Likewise
	* mh/send.c: Likewise
	* movemail/movemail.c: Likewise
	* pop3d/apop.c: Likewise
	* pop3d/extra.c: Likewise
	* pop3d/lock.c: Likewise
	* pop3d/pop3d.c: Likewise
	* pop3d/popauth.c: Likewise
	* pop3d/signal.c: Likewise
	* readmsg/readmsg.c: Likewise
	* sieve/sieve.c: Likewise

	* mail/testsuite/mail/read.exp: Updated to match new output format
	of the decode command

2005-01-04  Sergey Poznyakoff

	* mailbox/errors: Add gettext markers
	* po/POTFILES.in: Depend on mailbox/errors directly
	* scripts/generr.awk: Assume textual messages are
	already quoted.

2005-01-02  Jordi Mallach

	* doc/texinfo/programs.texi: Typo fix.

2005-01-01  Sergey Poznyakoff

	Generate automatically errno.h and muerrno.c from a single
	plain text file. This facilitates maintaining of mailutils-
	specific error codes.
	
	* include/mailutils/errno.h: Removed
	* include/mailutils/errno.hin: New file
	* include/mailutils/Makefile.am: Generate errno.h
	* mailbox/muerrno.c: Removed
	* mailbox/muerrno.cin: New file
	* mailbox/errors: New file
	* mailbox/Makefile.am: Generate muerrno.c
	* scripts/generr.awk: New file
	* scripts/Makefile.am: Add generr.awk

	Fix a recently spotted problem in the testsuite:
	
	* imap4d/testsuite/imap4d/list.exp: Use new -sort flag to
	avoid dependency on any particular ordering. Also corrected
	expected outputs due to inclusion of two new mailboxes quite
	some time ago (went unnoticed so far due to fuzzy matching
	technique + ordering-dependent output).
	* imap4d/testsuite/lib/imap4d.exp (imap4d_test): New flag -sort
	toggles on sorting of untagged responces. Notice that -sort
	and -re are mutually exclusive.
	* testsuite/lib/mailutils.exp (mu_test): Upvar expect_out	
	
2004-12-28  Wojciech Polak

	Fixed displaying mail headers in different languages.

	* mail/util.c (util_rfc2047_decode): Fixed reading
	a language environment variable.
	* frm/frm.c (rfc2047_decode_wrapper): Likewise.
	(util_getcols): Imported function from mail/util.c.
	(action): Try to print only one line per message.
	* from/from.c (rfc2047_decode_wrapper): Fixed.

2004-12-23  Sergey Poznyakoff

	* configure.ac: Version 0.6
	* NEWS: Likewise
	* README: Updated
	* auth/gsasl.c: Updated for GSASL >=0.2.3. Previous versions
	won't work.
	* auth/lbuf.c (_auth_lb_writelines): Bugfix
	* mail.local/mail.local.h (USE_MAILBOX_QUOTAS): New define
	* mail.local/mailquota.c: Use USE_MAILBOX_QUOTAS.
	(sql_retrieve_quota): Assume unlimited quotas for empty fields.
	* mail.local/main.c: Use USE_MAILBOX_QUOTAS.
	
2004-12-17  Sergey Poznyakoff

	* configure.ac: Do not allow to specify modules more than once
	* auth/sql.c (sql_escape_string): Escape ocurrences of ' and "
	in string.
	(mu_sql_expand_query): prevent possible sql injection
	* mail.local/mailquota.c (sql_retrieve_quota): Allow for NULL
	columns
	* sql/postgres.c (destroy): Bugfix: do not free pgconn

2004-12-05  Sergey Poznyakoff  

	* Makefile.am: Added sql/
	* configure.ac: Rewritten sql-related part. Allow to specify
	several SQL libraries simultaneously.

	* sql: New directory
	* sql/Makefile.am: New file
	* sql/.cvsignore: New file
	* sql/sql.c: New file
	* sql/mysql.c: New file
	* sql/postgres.c: New file
	
	* auth/mysql.c: Removed
	* auth/pgsql.c: Removed
	* auth/sql.c: Rewritten using general SQL interface.
	* auth/Makefile.am: Removed mysql.c and pgsql.c
	* include/mailutils/sql.h: New file
	* include/mailutils/Makefile.am: Added sql.h

	* include/mailutils/errno.h: Added new error codes.
	* mailbox/muerrno.c: Likewise.
	
	* mail.local/mail.local.h (quota_query): New variable
	* mail.local/mailquota.c: Retrieve quotas from SQL database
	* mail.local/main.c: New option --quota-query

	* scripts/sqlmod.sh: New file
	* scripts/Makefile.am: Added sqlmod.sh

	* doc/texinfo/programs.texi: Documented mailbox quotas

	* NEWS: Updated
	* README: Updated
	* po/POTFILES.in: Updated

2004-12-02  Sergey Poznyakoff

	* doc/texinfo/programs.texi: Documented movemail.

2004-11-18  Sergey Poznyakoff

	* mailbox/imap/folder.c (authenticate_imap_select): Use
	ENOSYS as the default status value to allow MU_ERR_AUTH_FAILURE
	to be propagated back to the caller.
	(imap_parse): Display "NO/Bad Tagged" error diagnostics only if
	status != MU_ERR_AUTH_FAILURE. Should we display it at all?
	* movemail/movemail.c: Emacs-iteraction mode (--emacs)

2004-11-17  Wojciech Polak

	Added initial version of `libmu_cpp',
	a C++ wrapper for Mailutils.

	* libmu_cpp: Added new directory.
	* libmu_cpp/address.cc: New file.
	* libmu_cpp/filter.cc: Likewise.
	* libmu_cpp/iterator.cc: Likewise.
	* libmu_cpp/mailbox.cc: Likewise.
	* libmu_cpp/mailer.cc: Likewise.
	* libmu_cpp/message.cc: Likewise.
	* libmu_cpp/stream.cc: Likewise.
	* libmu_cpp/header.cc: Likewise.
	* libmu_cpp/list.cc: Likewise.
	* libmu_cpp/mailcap.cc: Likewise.
	* libmu_cpp/pop3.cc: Likewise.
	* libmu_cpp/url.cc: Likewise.
	* libmu_cpp/Makefile.am: Likewise.

	* include/mailutils/cpp: Added new directory.
	* include/mailutils/cpp/address.h: New file.
	* include/mailutils/cpp/error.h: Likewise.
	* include/mailutils/cpp/header.h: Likewise.
	* include/mailutils/cpp/list.h: Likewise.
	* include/mailutils/cpp/mailcap.h: Likewise.
	* include/mailutils/cpp/mailutils.h: Likewise.
	* include/mailutils/cpp/message.h: Likewise.
	* include/mailutils/cpp/stream.h: Likewise.
	* include/mailutils/cpp/filter.h: Likewise.
	* include/mailutils/cpp/iterator.h: Likewise.
	* include/mailutils/cpp/mailbox.h: Likewise.
	* include/mailutils/cpp/mailer.h: Likewise.
	* include/mailutils/cpp/pop3.h: Likewise.
	* include/mailutils/cpp/url.h: Likewise.
	* include/mailutils/cpp/Makefile.am: Likewise.

	* examples/cpp/addr.cc: New file.
	* examples/cpp/http.cc: Likewise.
	* examples/cpp/listop.cc: Likewise.
	* examples/cpp/sfrom.cc: Likewise.
	* examples/cpp/iconv.cc: Likewise.
	* examples/cpp/mailcap.cc: Likewise.
	* examples/cpp/murun.cc: Likewise.
	* examples/cpp/url-parse.cc: Likewise.
	* examples/cpp/Makefile.am: Likewise.
	
2004-11-15  Wojciech Polak

	* examples/config: New directory.
	* examples/cpp: Likewise.
	* examples/scheme: Likewise.
	* examples/config/Makefile.am: New file.
	* examples/cpp/Makefile.am: Likewise.
	* examples/scheme/Makefile.am: Likewise.

	* examples/comsat.conf: Moved to config/.
	* examples/dot.biffrc: Likewise.
	* examples/gnu-imap4d.pam: Likewise.
	* examples/gnu-pop3d.pam: Likewise.
	* examples/mailutils.rc: Likewise.
	* examples/reply.scm: Moved to scheme/.
	* examples/Makefile.am: Updated.
	* configure.ac: Updated.

2004-11-15  Sergey Poznyakoff 

	* imap4d/imap4d.c: New option --tls-required: do not allow
	authentication until TLS negotiation succeeds.
	* imap4d/authenticate.c (imap4d_authenticate): Do not proceed if
	tls_required is set.
	* imap4d/login.c (imap4d_login): Likewise.
	* imap4d/imap4d.h (IMAP_CAPA_STARTTLS,IMAP_CAPA_LOGINDISABLED)
	(IMAP_CAPA_XTLSREQUIRED): New defines
	* imap4d/starttls.c (imap4d_starttls): Clear tls_required upon
	successfull TLS handshake.
	(starttls_init): Use IMAP_CAPA_STARTTLS instead of hardcoded
	literal.
	* include/mailutils/header.h (MU_HEADER_X_EXPIRE_TIMESTAMP): New
	define.

	* pop3d/pop3d.c: New option --tls-required: do not allow
	authentication until TLS negotiation succeeds.
	New option --delete-expired: delete expired messages before
	closing the mailbox.
	* pop3d/capa.c (pop3d_capa): Announce XTLSREQUIRED if appropriate
	* pop3d/expire.c (expire_mark_message): New function
	* pop3d/pop3d.h: New declarations.
	* pop3d/quit.c (pop3d_fix_mark): Use expire_mark_message to
	process expired messages. Apart from the new functionality, it
	also fixes a bug: len was incorrectly used as a replace indicator
	in header_set_value, thus each retrieval of the message was
	resetting its expiration date.
	
	* pop3d/stls.c (pop3d_stls): Set state to AUTHORIZATION upon
	successful completion of TLS negotiation.

	* configure.ac: Raised version number to 0.5.1
	* NEWS: Entry for 0.5.1

2004-11-03  Sergey Poznyakoff 

	* dotlock/dotlock.c: Removed -T option (CAN-2004-0984)

2004-10-26  Sergey Poznyakoff

	* imap4d/store.c (imap4d_store0): Send \r\n at the end of
	the unsolicited response.

2004-09-18  Sergey Poznyakoff 

	* configure.ac: Bugfix
	* mailbox/mime.c (_mime_munge_content_header): Bugfix

2004-08-31  Wojciech Polak

	* mailbox/file_stream.c (prog_stream_create): Changed type
	of the second argument to const char*.
	(filter_prog_stream_create): Likewise.
	(_prog_stream_create): Changed type of the third argument
	to const char*.
	* include/mailutils/stream.h (prog_stream_create): Changed
	type of the second argument to const char*.
	(filter_prog_stream_create): Likewise.
	* doc/texinfo/stream.texi: Updated.

	* configure.ac (AM_GNU_GETTEXT_VERSION): Bump to 0.14.1.

2004-08-24  Sergey Poznyakoff

	* mail/util.c (util_do_command): Fixed coredump on unparseable
	input strings.
	* THANKS: Added Dan Jacobson

2004-08-20  Sergey Poznyakoff 

	* include/mailutils/guile.h (MU_SCM_SYMBOL_VALUE): New define
	(_mu_scm_mailer,_mu_scm_debug): Removed externs.
	* include/mailutils/list.h (list_set_destroy_item): Use __PMT in
	nested declarations.
	* libmu_scm/mu_message.c: Properly access mu-mailer and mu-message
	values.

2004-08-11  Sergey Poznyakoff

	* mail/send.c (mail_send0): Fixed coredump on reading a
	single escape char.

2004-08-08  Sergey Poznyakoff

	* headers/argp.h: Protect typedef int error_t by an additional
	#ifndef. Thanks Alex S. Moore <asmoore@edge.net> for helping
	find out the problem.

2004-08-07  Sergey Poznyakoff  

	* Makefile.am: Raised automake requirements to version
	1.8.5
	* examples/nntpclient.c: Minor fixes.
	* imap4d/Makefile.am (INCLUDES): Added -Imailbox
	* imap4d/imap4d.h: Added missing includes
	* include/mailutils/nls.h [!ENABLE_NLS]: Define gettext()
	* include/mailutils/nntp.h: Minor changes. The screen is 80x24!
	* mailbox/locker.c (_locker_lock_dotlock): Make sure the lock file
	is writable for the owner.
	* mailbox/imap/folder.c (authenticate_imap_sasl_anon): Use
	auth_state instead of state. Possibly this was a typo...
	* mailbox/include/imap0.h (struct _f_imap.capac): Changed
	type to int.
	* mailbox/maildir/mbox.c (maildir_gethostname): Fixed a gross
	memory allocation bug.

	* mailbox/message.c: Minor changes.
	* mailbox/mbox/url.c: Likewise.
	* mailbox/nntp/folder.c: Likewise.
	* mailbox/nntp/mbox.c: Likewise.
	* mailbox/nntp/nntp_article.c: Likewise.
	* mailbox/nntp/nntp_connect.c: Likewise.
	* mailbox/nntp/nntp_date.c: Likewise.
	* mailbox/nntp/nntp_head.c: Likewise.
	* mailbox/nntp/nntp_ihave.c: Likewise.
	* mailbox/nntp/nntp_post.c: Likewise.

	* scripts/guile-1.6/guile-doc-snarf: Bugfix. Always use $AWK.

2004-08-06  Sergey Poznyakoff

	* include/mailutils/daemon.h: Include types.h

2004-07-07  Sergey Poznyakoff

	* libsieve/extensions/spamd.c (decode_float): Return
	signed long value, as SpamAssassin scores can be negative.
	(spamd_test): Updated accordingly

2004-07-05  Sergey Poznyakoff

	* include/mailutils/registrar.h (mu_register_extra_formats): New
	macro.
	(mu_register_all_formats): Call mu_register_extra_formats()
	* mailbox/mu_argp.c (mu_conf_option): Added ENABLE_NNTP
	* mailbox/nntp/Makefile.am: Add nntp0.h
	* mh/Makefile.am: Added libmu_nntp.la
	* readmsg/readmsg.c (main): Call mu_register_extra_formats()

2004-07-05  Sergey Poznyakoff 

	* include/mailutils/registrar.h (mu_register_all_mbox_formats):
	Removed nntp_record. It is not a *mailbox* format.
	* mailbox/mailutils-config.c: Added mu_nntp
	
	* mailbox/include/iterator0.h (_iterator.getitem): Changed
	declaration. There's no use passing a pointer to the const
	location, since the function *must* assign to it anyway.
	* include/mailutils/iterator.h (iterator_set_getitem): Changed
	declaration
	* mailbox/iterator.c (iterator_set_getitem): Changed
	declaration
	(iterator_current): Additional typecast on pitem
	
	* mailbox/list.c: Updated declaration of getitem method.
	* mailbox/nntp/nntp_iterator.c: Likewise
	* mailbox/pop/pop3_iterator.c: Likewise
	
	* mailbox/mailbox.c: Include <list.h>
	* mailbox/mailer.c: Likewise

2004-07-05  Alain Magloire

	* configure.ac: enable NNTP support.

	* example/Makefile.am: Enable NNTP.
	* frm/Makefile.am: Enable NNTP.
	* from/Makefile.am: Enable NNTP.
	* messages/Makefile.am: Enable NNTP.
	* readmsg/Makefile.am: Enable NNTP.
	* guimb/Makefile.am: Enable NNTP.
	* mail/Makefile.am: Enable NNTP.
	* sieve/Makefile.am: Enable NNTP.

	* imap4d/Makefile.am: Put @AUTHLIBS@ before libmailbox.a (failed
	on cygwin if not).
	* pop3d/Makefile.am: Put @AUTHLIBS@ before libmailbox.a (failed on
	cygwin if not).
	* mail.local/Makefile.am: Put @AUTHLIBS@ before libmailbox.a
	(failed on cygwin if not).

	* mailbox/stream.c (stream_wait): Bugfix.  If we buffer return
	true if the cache still	have data.

	* include/mailutils/nntp.h: Define the default NNTP port number.
	* include/mailutils/pop3.h: Define the default POP3 port number.
	* include/mailutils/registrar.h: Enable NNTP.

	* mailbox/nntp/folder.c: New file.
	* mailbox/nntp/mbox.c: New file.
	* mailbox/nntp/url.c: New file.
	* mailbox/nntp/Makefile.am: Updated.

2004-07-03  Sergey Poznyakoff

	* mailbox/list.c (list_data_dup): Bugfix: *ptr was not assigned.
	* doc/texinfo/muint.texi: Automake does	not allow two independent
	texi sources to include the same file (version.texi, in this
	case). What a stupid lossage! However it handles all files whose
	name matches "vers*.texi" as version.texi, which allows to
	override the bug: include vers-muint.texi instead of version.texi.

2004-07-01  Sergey Poznyakoff

	* include/mailutils/iterator.h (iterator_current)
	(iterator_set_getitem): Changed proto
	(iterator_get_list): Removed.
	* mailbox/include/iterator0.h (struct _iterator.getitem): Changed
	declaration.
	* mailbox/iterator.c (iterator_current)
	(iterator_set_getitem): Changed declaration
	* mailbox/list.c (getitem): Changed declaration

	* mailbox/rfc2047.c (rfc2047_decode): Fixed buffer
	handling

	* examples/mta.c: Minor fix
	* examples/nntpclient.c: Fixed printf formats
	(com_newgroups,com_newnews): Variable declarations are only allowed
	before the statements.

	* mailbox/nntp/nntp_article.c: Fixed printf formats
	* mailbox/nntp/nntp_body.c: Likewise
	* mailbox/nntp/nntp_head.c: Likewise

	* mailbox/nntp/nntp_iterator.c: Added missing include
	(nntp_itr_getitem): Changed declaration

	* mailbox/pop/pop3_iterator.c (pop3_itr_getitem): Changed
	declaration

2004-06-30  Alain Magloire

	* configure.ac: Add nntp directory.
	* doc/rfc/pop3.texit: add new API.

	* mailbox/Makefile.am: Add nntp directory.

	* mailbox/nntp/Makefile.am: Add new files.
	* mailbox/nntp/nntp_iterator.c: New file.
	* mailbox/nntp/nntp_list_active.c: Use the an iterator_t instead of a lis_t..
	* mailbox/nntp/nntp_list_distribpats.c: instead of a lis_t. file.
	* mailbox/nntp/nntp_list_times.c: instead of a lis_t. file.
	* mailbox/nntp/nntp_list_newgroups.c: instead of a lis_t. file.
	* mailbox/nntp/nntp_list_newnews.c: instead of a lis_t. file.

	* mailbox/pop3/Makefile.am: Add new files.
	* mailbox/pop3/pop3_iterator.c: New file.
	* mailbox/pop3/pop3_capa.c: instead of a lis_t. file.
	* mailbox/pop3/pop3_lista.c: instead of a lis_t. file.
	* mailbox/pop3/pop3_uidla.c: instead of a lis_t. file.

	* include/mailutils/Makefile.am: Add nntp.h and pop3.h.
	* include/mailutils/nntp.h: Add new declarations.
	* include/mailutils/sys/Makefile.am: Add nntp and pop3.hh
	* include/mailutils/sys/nntp.h: Add new declarations.
	* include/mailutils/pop3.h: NAdd new declarations.

	* example/Makefile.am: Adusted to new API.
	* example/nntpclient.c: Adusted to new API.
	* example/pop3client.c: Adusted to new API.
	* example/.cvsignore: Add nntpclient.

2004-06-30  Alain Magloire

	* mailbox/list.c (list_get_iterator): Bug fix, wrong size for calloc()
	(list_data_dup): Copy the elements.

2004-06-30  Sergey Poznyakoff

	* libsieve/extensions/spamd.c (spamd_shutdown): Bugfix

2004-06-29  Alain Magloire

	Continuing the framework for NNTP support

	* mailbox/nntp/.cvsignore: New file.
	* mailbox/nntp/nntp_help.c: New file.
	* mailbox/nntp/nntp_ihave.c: New file.
	* mailbox/nntp/nntp_list_active.c: New file.
	* mailbox/nntp/nntp_list_distribpats.c: New file.
	* mailbox/nntp/nntp_list_distributions.c: New file.
	* mailbox/nntp/nntp_list_newsgroups.c: New file.
	* mailbox/nntp/nntp_list_times.c: New file.
	* mailbox/nntp/nntp_newgroups.c: New file.
	* mailbox/nntp/nntp_newnews.c: New file.
	* mailbox/nntp/nntp_post.c: New file.

	* mailbox/nntp/nntp_article.c: implementation.
	* mailbox/nntp/nntp_body.c: implementation.
	* mailbox/nntp/nntp_connect.c: implementation.
	* mailbox/nntp/nntp_date.c: implementation.
	* mailbox/nntp/nntp_destroy.c: implementation.
	* mailbox/nntp/nntp_group.c: implementation.
	* mailbox/nntp/nntp_head.c: implementation.
	* mailbox/nntp/nntp_list_extensions.c: implementation.
	* mailbox/nntp/nntp_stat.c: implementation.
	* mailbox/nntp/nntp_stream.c: implementation.

	* include/mailutils/nntp.h: Declarations.
	* include/mailutils/sys/nntp.h: Declarations.

	* examples/nntpclient.c: Adujsted.
	* examples/pop3client.c: Minor bug fixes.

2004-06-28  Sergey Poznyakoff

	* mailbox/filter_iconv.c (internal_icvt_read)
	(copy_pass): Fixed mistyped conditions.

	* mailbox/include/iterator0.h (struct _iterator): rewritten as
	a general-purpose iterator structure.
	* include/mailutils/iterator.h (iterator_create): Changed
	proto.
	(iterator_attach,iterator_detach,iterator_advance)
	(iterator_set_first,iterator_set_next)
	(iterator_set_getitem,iterator_set_finished_p)
	(iterator_set_dup,iterator_set_destroy): New functions.
	* mailbox/iterator.c: Likewise
	* include/mailutils/list.h (list_get_iterator): New function
	* mailbox/list.c: Likewise

	* examples/listop.c: Replace iterator_create with
	list_get_iterator.
	* examples/nntpclient.c: Likewise
	* examples/pop3client.c: Likewise
	* imap4d/util.c: Likewise
	* libsieve/comparator.c: Likewise
	* libsieve/prog.c: Likewise
	* libsieve/register.c: Likewise
	* libsieve/require.c: Likewise
	* libsieve/sieve.l: Likewise
	* mail/retain.c: Likewise
	* mail/util.c: Likewise
	* mailbox/filter.c: Likewise
	* mailbox/folder.c: Likewise
	* mailbox/mailbox.c: Likewise
	* mailbox/mailer.c: Likewise
	* mailbox/mu_auth.c: Likewise
	* mailbox/mutil.c: Likewise
	* mailbox/observer.c: Likewise
	* mh/ali.c: Likewise
	* mh/mh_alias.y: Likewise
	* mh/pick.y: Likewise
	* mh/refile.c: Likewise

2004-06-27  Sergey Poznyakoff

	* direntry: New file

2004-06-27  Sergey Poznyakoff

	See ChangeLog.0.5 for earlier entries


Local Variables:
mode: change-log
version-control: never
End:
